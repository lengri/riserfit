<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>riserfit documentation &mdash; riserfit 0.0.2 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Licence" href="licence.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            riserfit
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="diffusion_equations.html">Diffusion equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="licence.html">Licence</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">riserfit documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-riserfit.dem">riserfit.dem module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.dem.Constructor_Extractor"><code class="docutils literal notranslate"><span class="pre">Constructor_Extractor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.dem.Constructor_Extractor.build_center_profiles"><code class="docutils literal notranslate"><span class="pre">Constructor_Extractor.build_center_profiles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.dem.Constructor_Extractor.build_decomposed_point_list"><code class="docutils literal notranslate"><span class="pre">Constructor_Extractor.build_decomposed_point_list()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.dem.Constructor_Extractor.build_swath_profiles"><code class="docutils literal notranslate"><span class="pre">Constructor_Extractor.build_swath_profiles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.dem.Constructor_Extractor.reconstruct_elevation_list"><code class="docutils literal notranslate"><span class="pre">Constructor_Extractor.reconstruct_elevation_list()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.dem.calculate_aspect"><code class="docutils literal notranslate"><span class="pre">calculate_aspect()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.dem.construct_z_profiles_from_centerpoints"><code class="docutils literal notranslate"><span class="pre">construct_z_profiles_from_centerpoints()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.dem.extrapolate_line_from_point"><code class="docutils literal notranslate"><span class="pre">extrapolate_line_from_point()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.dem.load_profile_csvs"><code class="docutils literal notranslate"><span class="pre">load_profile_csvs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.dem.sample_raster_at_points"><code class="docutils literal notranslate"><span class="pre">sample_raster_at_points()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-riserfit.diffusion">riserfit.diffusion module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.diffusion.TridiagonalElimination"><code class="docutils literal notranslate"><span class="pre">TridiagonalElimination</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.diffusion.TridiagonalElimination.solve"><code class="docutils literal notranslate"><span class="pre">TridiagonalElimination.solve()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.diffusion.animate_profile_diffusion"><code class="docutils literal notranslate"><span class="pre">animate_profile_diffusion()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.diffusion.lin_diffusion_crank_nicolson"><code class="docutils literal notranslate"><span class="pre">lin_diffusion_crank_nicolson()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.diffusion.lin_diffusion_exp_fwd_time"><code class="docutils literal notranslate"><span class="pre">lin_diffusion_exp_fwd_time()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.diffusion.lin_diffusion_impl_backwd_time"><code class="docutils literal notranslate"><span class="pre">lin_diffusion_impl_backwd_time()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.diffusion.nonlin_diff_gabet2021"><code class="docutils literal notranslate"><span class="pre">nonlin_diff_gabet2021()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.diffusion.nonlin_diff_perron2011"><code class="docutils literal notranslate"><span class="pre">nonlin_diff_perron2011()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.diffusion.nonlin_diffusion_explicit"><code class="docutils literal notranslate"><span class="pre">nonlin_diffusion_explicit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.diffusion.nonlin_diffusion_explicit_Perron2011"><code class="docutils literal notranslate"><span class="pre">nonlin_diffusion_explicit_Perron2011()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-riserfit.profiles">riserfit.profiles module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.profiles.Riser"><code class="docutils literal notranslate"><span class="pre">Riser</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.add_cn_ages"><code class="docutils literal notranslate"><span class="pre">Riser.add_cn_ages()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.add_cn_terrace_ages"><code class="docutils literal notranslate"><span class="pre">Riser.add_cn_terrace_ages()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.add_parameter"><code class="docutils literal notranslate"><span class="pre">Riser.add_parameter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.add_parameter_from_file"><code class="docutils literal notranslate"><span class="pre">Riser.add_parameter_from_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.add_terrace_generation"><code class="docutils literal notranslate"><span class="pre">Riser.add_terrace_generation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.apply_d_z_offsets"><code class="docutils literal notranslate"><span class="pre">Riser.apply_d_z_offsets()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.azimuth"><code class="docutils literal notranslate"><span class="pre">Riser.azimuth</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.best_a"><code class="docutils literal notranslate"><span class="pre">Riser.best_a</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.best_b"><code class="docutils literal notranslate"><span class="pre">Riser.best_b</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.best_d_off"><code class="docutils literal notranslate"><span class="pre">Riser.best_d_off</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.best_kt"><code class="docutils literal notranslate"><span class="pre">Riser.best_kt</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.best_midpoint_grad"><code class="docutils literal notranslate"><span class="pre">Riser.best_midpoint_grad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.best_misfit"><code class="docutils literal notranslate"><span class="pre">Riser.best_misfit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.best_theta"><code class="docutils literal notranslate"><span class="pre">Riser.best_theta</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.best_z_off"><code class="docutils literal notranslate"><span class="pre">Riser.best_z_off</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.build_Riser_instance_dataframe"><code class="docutils literal notranslate"><span class="pre">Riser.build_Riser_instance_dataframe()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.calculate_kt_uncertainty"><code class="docutils literal notranslate"><span class="pre">Riser.calculate_kt_uncertainty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.calculate_nonlin_t_uncertainty"><code class="docutils literal notranslate"><span class="pre">Riser.calculate_nonlin_t_uncertainty()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.calculate_parameter_uncertainties"><code class="docutils literal notranslate"><span class="pre">Riser.calculate_parameter_uncertainties()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.calculate_upstream_distance"><code class="docutils literal notranslate"><span class="pre">Riser.calculate_upstream_distance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.cn_age"><code class="docutils literal notranslate"><span class="pre">Riser.cn_age</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.cn_age_reliability"><code class="docutils literal notranslate"><span class="pre">Riser.cn_age_reliability</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.cn_age_sigma"><code class="docutils literal notranslate"><span class="pre">Riser.cn_age_sigma</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.compute_azimuth"><code class="docutils literal notranslate"><span class="pre">Riser.compute_azimuth()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.compute_best_linear_diffusion_fit"><code class="docutils literal notranslate"><span class="pre">Riser.compute_best_linear_diffusion_fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.compute_best_nonlinear_diffusion_fit"><code class="docutils literal notranslate"><span class="pre">Riser.compute_best_nonlinear_diffusion_fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.compute_best_nonlinear_diffusion_fit_general"><code class="docutils literal notranslate"><span class="pre">Riser.compute_best_nonlinear_diffusion_fit_general()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.compute_gradients"><code class="docutils literal notranslate"><span class="pre">Riser.compute_gradients()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.compute_symmetry_index"><code class="docutils literal notranslate"><span class="pre">Riser.compute_symmetry_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.construct_StatsMC_instance"><code class="docutils literal notranslate"><span class="pre">Riser.construct_StatsMC_instance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.extract_profile_elevation"><code class="docutils literal notranslate"><span class="pre">Riser.extract_profile_elevation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.extract_subset"><code class="docutils literal notranslate"><span class="pre">Riser.extract_subset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.flip_profile_orientation"><code class="docutils literal notranslate"><span class="pre">Riser.flip_profile_orientation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.gradient"><code class="docutils literal notranslate"><span class="pre">Riser.gradient</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.jack_a"><code class="docutils literal notranslate"><span class="pre">Riser.jack_a</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.jack_b"><code class="docutils literal notranslate"><span class="pre">Riser.jack_b</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.jack_d"><code class="docutils literal notranslate"><span class="pre">Riser.jack_d</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.jack_d_off"><code class="docutils literal notranslate"><span class="pre">Riser.jack_d_off</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.jack_kt"><code class="docutils literal notranslate"><span class="pre">Riser.jack_kt</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.jack_midpoint_gradient"><code class="docutils literal notranslate"><span class="pre">Riser.jack_midpoint_gradient</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.jack_misfit"><code class="docutils literal notranslate"><span class="pre">Riser.jack_misfit</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.jack_optimize_summary"><code class="docutils literal notranslate"><span class="pre">Riser.jack_optimize_summary</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.jack_z"><code class="docutils literal notranslate"><span class="pre">Riser.jack_z</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.jack_z_off"><code class="docutils literal notranslate"><span class="pre">Riser.jack_z_off</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.jackknife_linear_diffusion_fit"><code class="docutils literal notranslate"><span class="pre">Riser.jackknife_linear_diffusion_fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.jackknife_nonlinear_diffusion_fit"><code class="docutils literal notranslate"><span class="pre">Riser.jackknife_nonlinear_diffusion_fit()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.lower_kt"><code class="docutils literal notranslate"><span class="pre">Riser.lower_kt</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.merge_Riser_instances"><code class="docutils literal notranslate"><span class="pre">Riser.merge_Riser_instances()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.mirror_upper_profile_half"><code class="docutils literal notranslate"><span class="pre">Riser.mirror_upper_profile_half()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.nonlin_best_mf"><code class="docutils literal notranslate"><span class="pre">Riser.nonlin_best_mf</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.nonlin_best_t"><code class="docutils literal notranslate"><span class="pre">Riser.nonlin_best_t</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.nonlin_best_z"><code class="docutils literal notranslate"><span class="pre">Riser.nonlin_best_z</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.nonlin_d"><code class="docutils literal notranslate"><span class="pre">Riser.nonlin_d</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.nonlin_dt"><code class="docutils literal notranslate"><span class="pre">Riser.nonlin_dt</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.nonlin_jack_best_t"><code class="docutils literal notranslate"><span class="pre">Riser.nonlin_jack_best_t</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.nonlin_lower_t"><code class="docutils literal notranslate"><span class="pre">Riser.nonlin_lower_t</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.nonlin_opt_sum"><code class="docutils literal notranslate"><span class="pre">Riser.nonlin_opt_sum</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.nonlin_t_times"><code class="docutils literal notranslate"><span class="pre">Riser.nonlin_t_times</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.nonlin_upper_t"><code class="docutils literal notranslate"><span class="pre">Riser.nonlin_upper_t</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.nonlin_z_matrix"><code class="docutils literal notranslate"><span class="pre">Riser.nonlin_z_matrix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.optimize_summary"><code class="docutils literal notranslate"><span class="pre">Riser.optimize_summary</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.plot_profile_map"><code class="docutils literal notranslate"><span class="pre">Riser.plot_profile_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.profile_elevation"><code class="docutils literal notranslate"><span class="pre">Riser.profile_elevation</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.resample_raster_along_profiles"><code class="docutils literal notranslate"><span class="pre">Riser.resample_raster_along_profiles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.save_Riser_instance_structure"><code class="docutils literal notranslate"><span class="pre">Riser.save_Riser_instance_structure()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.save_instance"><code class="docutils literal notranslate"><span class="pre">Riser.save_instance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.symmetry_index"><code class="docutils literal notranslate"><span class="pre">Riser.symmetry_index</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.terrace"><code class="docutils literal notranslate"><span class="pre">Riser.terrace</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.terrace_age"><code class="docutils literal notranslate"><span class="pre">Riser.terrace_age</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.terrace_age_sigma"><code class="docutils literal notranslate"><span class="pre">Riser.terrace_age_sigma</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.upper_kt"><code class="docutils literal notranslate"><span class="pre">Riser.upper_kt</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.profiles.Riser.upstream_distance"><code class="docutils literal notranslate"><span class="pre">Riser.upstream_distance</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.profiles.center_elevation_profiles"><code class="docutils literal notranslate"><span class="pre">center_elevation_profiles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.profiles.initialize_riser_class"><code class="docutils literal notranslate"><span class="pre">initialize_riser_class()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.profiles.load_Riser_instance_structure"><code class="docutils literal notranslate"><span class="pre">load_Riser_instance_structure()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.profiles.load_instance"><code class="docutils literal notranslate"><span class="pre">load_instance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.profiles.read_profile_files"><code class="docutils literal notranslate"><span class="pre">read_profile_files()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.profiles.reproject_profiles"><code class="docutils literal notranslate"><span class="pre">reproject_profiles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.profiles.split_elevation_profiles"><code class="docutils literal notranslate"><span class="pre">split_elevation_profiles()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-riserfit.riser_maths">riserfit.riser_maths module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.DistributionFromInterpolator"><code class="docutils literal notranslate"><span class="pre">DistributionFromInterpolator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.riser_maths.DistributionFromInterpolator.sample"><code class="docutils literal notranslate"><span class="pre">DistributionFromInterpolator.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.StatsMC"><code class="docutils literal notranslate"><span class="pre">StatsMC</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.riser_maths.StatsMC.construct_MC_k_kde"><code class="docutils literal notranslate"><span class="pre">StatsMC.construct_MC_k_kde()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.riser_maths.StatsMC.construct_MC_t_kde"><code class="docutils literal notranslate"><span class="pre">StatsMC.construct_MC_t_kde()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.riser_maths.StatsMC.construct_initial_t_kde"><code class="docutils literal notranslate"><span class="pre">StatsMC.construct_initial_t_kde()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.riser_maths.StatsMC.construct_kt_kde"><code class="docutils literal notranslate"><span class="pre">StatsMC.construct_kt_kde()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.riser_maths.StatsMC.construct_paired_t_kde"><code class="docutils literal notranslate"><span class="pre">StatsMC.construct_paired_t_kde()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.riser_maths.StatsMC.save_instance"><code class="docutils literal notranslate"><span class="pre">StatsMC.save_instance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.riser_maths.StatsMC.set_k_kde"><code class="docutils literal notranslate"><span class="pre">StatsMC.set_k_kde()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.analytical_derivative"><code class="docutils literal notranslate"><span class="pre">analytical_derivative()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.analytical_profile"><code class="docutils literal notranslate"><span class="pre">analytical_profile()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.calculate_function_jacobian"><code class="docutils literal notranslate"><span class="pre">calculate_function_jacobian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.calculate_wei_2015_sigma"><code class="docutils literal notranslate"><span class="pre">calculate_wei_2015_sigma()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.compute_misfit"><code class="docutils literal notranslate"><span class="pre">compute_misfit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.construct_averaged_kde"><code class="docutils literal notranslate"><span class="pre">construct_averaged_kde()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.distance_along_line"><code class="docutils literal notranslate"><span class="pre">distance_along_line()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.distribution_from_sample"><code class="docutils literal notranslate"><span class="pre">distribution_from_sample()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.gaussian"><code class="docutils literal notranslate"><span class="pre">gaussian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.gaussian_kernel"><code class="docutils literal notranslate"><span class="pre">gaussian_kernel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.kde_gaussian"><code class="docutils literal notranslate"><span class="pre">kde_gaussian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.least_square_reproject"><code class="docutils literal notranslate"><span class="pre">least_square_reproject()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.load_StatsMC_instance"><code class="docutils literal notranslate"><span class="pre">load_StatsMC_instance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.maximum_combined_kde"><code class="docutils literal notranslate"><span class="pre">maximum_combined_kde()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.propagate_division_error"><code class="docutils literal notranslate"><span class="pre">propagate_division_error()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.riser_covariance_matrix"><code class="docutils literal notranslate"><span class="pre">riser_covariance_matrix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.triang_kde"><code class="docutils literal notranslate"><span class="pre">triang_kde()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.triang_kernel"><code class="docutils literal notranslate"><span class="pre">triang_kernel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.riser_maths.xy_distances"><code class="docutils literal notranslate"><span class="pre">xy_distances()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-riserfit.statistics">riserfit.statistics module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.statistics.RiserPlayground"><code class="docutils literal notranslate"><span class="pre">RiserPlayground</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.statistics.RiserPlayground.add_gaussian_z_noise"><code class="docutils literal notranslate"><span class="pre">RiserPlayground.add_gaussian_z_noise()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.statistics.RiserPlayground.best_fit_gaussian_z_noise"><code class="docutils literal notranslate"><span class="pre">RiserPlayground.best_fit_gaussian_z_noise()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.statistics.RiserPlayground.best_nonlin_fit_gaussian_z_noise"><code class="docutils literal notranslate"><span class="pre">RiserPlayground.best_nonlin_fit_gaussian_z_noise()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.statistics.RiserPlayground.create_profiles_from_parameters"><code class="docutils literal notranslate"><span class="pre">RiserPlayground.create_profiles_from_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.statistics.RiserPlayground.downsample_upsample_profiles"><code class="docutils literal notranslate"><span class="pre">RiserPlayground.downsample_upsample_profiles()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#riserfit.statistics.RiserPlayground.load_profiles_from_Riser"><code class="docutils literal notranslate"><span class="pre">RiserPlayground.load_profiles_from_Riser()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.statistics.calculate_confidence_interval"><code class="docutils literal notranslate"><span class="pre">calculate_confidence_interval()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.statistics.calculate_lin_reg_confidence_interval"><code class="docutils literal notranslate"><span class="pre">calculate_lin_reg_confidence_interval()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.statistics.linear_regression"><code class="docutils literal notranslate"><span class="pre">linear_regression()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#riserfit.statistics.sample_2d_grid"><code class="docutils literal notranslate"><span class="pre">sample_2d_grid()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">riserfit</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">riserfit documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/riserfit.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="riserfit-documentation">
<h1>riserfit documentation<a class="headerlink" href="#riserfit-documentation" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-riserfit.dem">
<span id="riserfit-dem-module"></span><h2>riserfit.dem module<a class="headerlink" href="#module-riserfit.dem" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="riserfit.dem.Constructor_Extractor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">riserfit.dem.</span></span><span class="sig-name descname"><span class="pre">Constructor_Extractor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centerpoints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_end_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing_array</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swath_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swath_spacing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/riserfit/dem.html#Constructor_Extractor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.dem.Constructor_Extractor" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Internal class for handeling profile building and
extracting elevation values from a DEM.</p>
<dl class="py method">
<dt class="sig sig-object py" id="riserfit.dem.Constructor_Extractor.build_center_profiles">
<span class="sig-name descname"><span class="pre">build_center_profiles</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/dem.html#Constructor_Extractor.build_center_profiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.dem.Constructor_Extractor.build_center_profiles" title="Permalink to this definition"></a></dt>
<dd><p>Build the center lines XY-coordinates of the elevation profile.
Center points and line orientations are supplied when initializing
the <code class="docutils literal notranslate"><span class="pre">Constructor_Extractor</span></code> instance and stored in
<code class="docutils literal notranslate"><span class="pre">self.centerpoints</span></code> and <code class="docutils literal notranslate"><span class="pre">self.directions</span></code>. Similarly,
spacing and number of points are supplied during instance
creation.#</p>
<section id="returns">
<h3>Returns:<a class="headerlink" href="#returns" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">Constructor_Extractor</span></code> instance. XY coordinates
of the created lines are stored in <code class="docutils literal notranslate"><span class="pre">self.centerlines</span></code>.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.dem.Constructor_Extractor.build_decomposed_point_list">
<span class="sig-name descname"><span class="pre">build_decomposed_point_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/dem.html#Constructor_Extractor.build_decomposed_point_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.dem.Constructor_Extractor.build_decomposed_point_list" title="Permalink to this definition"></a></dt>
<dd><p>Flattens the nested lists stored in <code class="docutils literal notranslate"><span class="pre">self.swath_list</span></code> into
a single flat list while keeping track of original point
associations. This method is used to enable more efficient sampling
of elevation values from a DEM.</p>
<section id="id1">
<h3>Returns:<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">Constructor_Extractor</span></code> instance. The decomposed
points are stored in <code class="docutils literal notranslate"><span class="pre">self.decomposed_single_line_points</span></code>, or
<code class="docutils literal notranslate"><span class="pre">self.decomposed_swath_line_points</span></code>, if <code class="docutils literal notranslate"><span class="pre">self.swath_number&gt;0</span></code>.
Point associations to reconstruct the nested list are stored in <code class="docutils literal notranslate"><span class="pre">self.ordered_line_len_counter</span></code></p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.dem.Constructor_Extractor.build_swath_profiles">
<span class="sig-name descname"><span class="pre">build_swath_profiles</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/dem.html#Constructor_Extractor.build_swath_profiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.dem.Constructor_Extractor.build_swath_profiles" title="Permalink to this definition"></a></dt>
<dd><p>Build swath lines around the center profile lines created by
<code class="docutils literal notranslate"><span class="pre">Constructor_Extractor.build_center_profiles()</span></code>. This method
raises an error if <code class="docutils literal notranslate"><span class="pre">build_center_profiles()</span></code> has not been
called before calling this method.</p>
<section id="id2">
<h3>Returns:<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">Constructor_Extractor</span></code> instance with swath coordinates stored in <code class="docutils literal notranslate"><span class="pre">self.swath_list</span></code>.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.dem.Constructor_Extractor.reconstruct_elevation_list">
<span class="sig-name descname"><span class="pre">reconstruct_elevation_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/dem.html#Constructor_Extractor.reconstruct_elevation_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.dem.Constructor_Extractor.reconstruct_elevation_list" title="Permalink to this definition"></a></dt>
<dd><p>Re-form a nested list, grouped according to profiles, swaths, points.
This function relates to <code class="docutils literal notranslate"><span class="pre">Constructor_Extractor.build_decomposed_point_list()</span></code>.</p>
<section id="parameters">
<h3>Parameters:<a class="headerlink" href="#parameters" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>z: np.ndarray</dt><dd><p>Elevations extracted from the DEM.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id3">
<h3>Returns:<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The <code class="docutils literal notranslate"><span class="pre">Constructor_Extractor</span></code> instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.dem.calculate_aspect">
<span class="sig-prename descclassname"><span class="pre">riserfit.dem.</span></span><span class="sig-name descname"><span class="pre">calculate_aspect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rasterpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_no</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_first</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rio_open_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/riserfit/dem.html#calculate_aspect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.dem.calculate_aspect" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the local aspect of a list of points given in row-column format
<span class="math notranslate nohighlight">\((y, x)\)</span> on a DEM in the same coordinate system.</p>
<section id="id4">
<h3>Parameters:<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>rasterpath: str</dt><dd><p>Path to the DEM.</p>
</dd>
<dt>rc_points: list[tuple]</dt><dd><p>List of points stored as <span class="math notranslate nohighlight">\((y, x)\)</span> tuples.</p>
</dd>
<dt>band_no: int</dt><dd><p>Band of the input raster to be interpreted as the DEM.</p>
</dd>
<dt>smooth_first: bool</dt><dd><p>Option to perform the azimuth calculation on a smoothed DEM.
This will generally lead to better results, unless the topography
is very complex.</p>
</dd>
<dt>method: str</dt><dd><p>Method used to calculate and interpolate the elevation values at the
wanted points. Can take any value permitted by
<code class="docutils literal notranslate"><span class="pre">scipy.interpolate.interpn()</span></code>.</p>
</dd>
<dt>rio_open_dict: dict</dt><dd><p>Any additional parameters passed on to rio.open().</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id5">
<h3>Returns:<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>azimuths: list[tuple]</dt><dd><p>List of <span class="math notranslate nohighlight">\((y, x)\)</span> tuples representing the vector pointing in the
direction of steepest descent, in the same order as <code class="docutils literal notranslate"><span class="pre">rc_points</span></code>.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.dem.construct_z_profiles_from_centerpoints">
<span class="sig-prename descclassname"><span class="pre">riserfit.dem.</span></span><span class="sig-name descname"><span class="pre">construct_z_profiles_from_centerpoints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rasterpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pointfilepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">namecol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'name'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'y'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_end_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.4142135623730951</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swath_number</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">swath_spacing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_no</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooth_first</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savedir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'DEM_profiles'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">view_profiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dem_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dem_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">800.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_csv_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/riserfit/dem.html#construct_z_profiles_from_centerpoints"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.dem.construct_z_profiles_from_centerpoints" title="Permalink to this definition"></a></dt>
<dd><p>Load a .csv containing a list of profile center points, construct
profile lines from them, and save them in separate .csv files. Also
returns the created pandas.DataFrame.</p>
<section id="id6">
<h3>Parameters:<a class="headerlink" href="#id6" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>rasterpath: str</dt><dd><p>Path to DEM raster (ideally a .tif file or similar).</p>
</dd>
<dt>pointfilepath: str</dt><dd><p>Path to .csv file containing points acting as centers for profile
lines.</p>
</dd>
<dt>namecol: str</dt><dd><p>Column name in .csv file for the profile names.</p>
</dd>
<dt>df_x: str</dt><dd><p>Name of x coordinate column in .csv file.</p>
</dd>
<dt>df_y: str</dt><dd><p>Name of y coordinate column in .csv file.</p>
</dd>
<dt>n_points: int</dt><dd><p>Number of points to be projected in each direction from centerpoint
defined by the .csv file in pointfilepath. Total number of points
will be <span class="math notranslate nohighlight">\(2 \cdot n_points + 1\)</span>.
Alternatively, if <code class="docutils literal notranslate"><span class="pre">n_points</span></code> is a string, it is interpreted as
the .csv column containing n_points information for each
center point separately.</p>
</dd>
<dt>spacing: float or str</dt><dd><p>Spacing between two consecutive points in the profile.
Alternatively, if spacing is a string, it is interpreted as
the .csv column containing spacing information for each
profile separately.</p>
</dd>
<dt>swath_number: int</dt><dd><p>Number of parallel lines extracted for each profile. Total number
is <span class="math notranslate nohighlight">\(2 \cdot swath_number + 1\)</span>.</p>
</dd>
<dt>swath_spacing: float</dt><dd><p>Distance between the swath lines of a profile.</p>
</dd>
<dt>band_no: int</dt><dd><p>Number of band to be interpreted as the DEM in rasterpath file.
Default is 1.</p>
</dd>
<dt>smooth_first: bool</dt><dd><p>Use a smoothed DEM to calculate the aspect. This will not affect
the elevation values extracted from the DEM.</p>
</dd>
<dt>method: str</dt><dd><p>Interpolation method for extracting values from the DEM. Default
is linear interpolation. Can take any values recognized by
<code class="docutils literal notranslate"><span class="pre">scipy.interpolate.interpn()</span></code>.</p>
</dd>
<dt>savedir: str</dt><dd><p>File path to directory where files are to be saved. If it does not
exist, the directory is created.</p>
</dd>
<dt>verbose: bool</dt><dd><p>If True, print some status updates while processing.</p>
</dd>
<dt>read_csv_kwargs: dict</dt><dd><p>Additional parameters passed to pandas.read_csv().</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id7">
<h3>Returns:<a class="headerlink" href="#id7" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>profiles: list</dt><dd><p>A list of pandas dataframes that can be forwarded into
<code class="docutils literal notranslate"><span class="pre">riserfit.initialize_riser_class()</span></code>.</p>
</dd>
<dt>names: list</dt><dd><p>A list of profile names that can be forwarded into
<code class="docutils literal notranslate"><span class="pre">riserfit.initialize_riser_class()</span></code>.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.dem.extrapolate_line_from_point">
<span class="sig-prename descclassname"><span class="pre">riserfit.dem.</span></span><span class="sig-name descname"><span class="pre">extrapolate_line_from_point</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">centerpoint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spacing</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.5</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/riserfit/dem.html#extrapolate_line_from_point"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.dem.extrapolate_line_from_point" title="Permalink to this definition"></a></dt>
<dd><p>Returns an array of points defining a profile line that can be fed into
sample_raster_at_points(). Input should be in row-column format (first
entry in tuple denotes the row or y position, second entry the col or x
position).</p>
<section id="id8">
<h3>Parameters:<a class="headerlink" href="#id8" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>centerpoint: tuple</dt><dd><p>The point of origin. A profile will be constructed with n_points in
the direction of vector and <span class="math notranslate nohighlight">\(-1\cdot vector\)</span> for a total of <span class="math notranslate nohighlight">\(2\cdot n_points+1\)</span>
points.</p>
</dd>
<dt>direction: tuple</dt><dd><p>A tuple defining the orientation of the profile line.
The line is constructed as <span class="math notranslate nohighlight">\(new_points = centerpoint+a\cdot direction\)</span>.</p>
</dd>
<dt>n_points: int</dt><dd><p>Number of point to be returned in each direction of the centerpoint.</p>
</dd>
<dt>spacing: float</dt><dd><p>Spacing between any two neighbouring points.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id9">
<h3>Returns:<a class="headerlink" href="#id9" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>rc_points: list[tuple]</dt><dd><p>An array of point tuples ordered along the first dimension.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.dem.load_profile_csvs">
<span class="sig-prename descclassname"><span class="pre">riserfit.dem.</span></span><span class="sig-name descname"><span class="pre">load_profile_csvs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pandas_csv_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dir</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/riserfit/dem.html#load_profile_csvs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.dem.load_profile_csvs" title="Permalink to this definition"></a></dt>
<dd><p>load existing profile .csv files located in a splitprofilescenterprofiles
folder.</p>
<section id="id10">
<h3>Parameters:<a class="headerlink" href="#id10" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>filepath: str</dt><dd><p>Path from current working directory to the directory containing
the .csv files to be loaded.</p>
</dd>
<dt>pandas_csv_dir: dir</dt><dd><p>Any arguments passed to <code class="docutils literal notranslate"><span class="pre">pandas.read_csv()</span></code>.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id11">
<h3>Returns:<a class="headerlink" href="#id11" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>profiles: list</dt><dd><p>List of pd.DataFrame containing the profiles.</p>
</dd>
<dt>names: list</dt><dd><p>List of names corresponding to the profiles.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.dem.sample_raster_at_points">
<span class="sig-prename descclassname"><span class="pre">riserfit.dem.</span></span><span class="sig-name descname"><span class="pre">sample_raster_at_points</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rasterpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rc_points</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_no</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rio_open_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/riserfit/dem.html#sample_raster_at_points"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.dem.sample_raster_at_points" title="Permalink to this definition"></a></dt>
<dd><p>This function samples a raster that can be read by rasterio at the required
points using a user-defined interpolation method. Points should be given in
(row, column) / (y, x) format.</p>
<section id="id12">
<h3>Parameters:<a class="headerlink" href="#id12" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>rasterpath: str</dt><dd><p>Relative path from current working directory (os.getcwd()) to the
raster file containing a DEM.</p>
</dd>
<dt>rc_points: np.array</dt><dd><p>1D array containing y,x coordinate tuples of the points where the
raster should be sampled at.</p>
</dd>
<dt>method: str</dt><dd><p>Interpolation method used by scipy.interpolate.interpn().
Default is linear interpolation.</p>
</dd>
<dt>band_no: int</dt><dd><p>Specifies the band of the raster that will be read as the DEM.</p>
</dd>
<dt>rio_open_dict: dict</dt><dd><p>Any parameters relating to rasterio.open()</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id13">
<h3>Returns:<a class="headerlink" href="#id13" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>rc_int: np.ndarray</dt><dd><p>List of elevation values corresponding to the points in rc_points.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

</section>
<section id="module-riserfit.diffusion">
<span id="riserfit-diffusion-module"></span><h2>riserfit.diffusion module<a class="headerlink" href="#module-riserfit.diffusion" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="riserfit.diffusion.TridiagonalElimination">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">riserfit.diffusion.</span></span><span class="sig-name descname"><span class="pre">TridiagonalElimination</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/riserfit/diffusion.html#TridiagonalElimination"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.diffusion.TridiagonalElimination" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Solve matrix elimination problem of form M*y = r:</p>
<div class="line-block">
<div class="line">b[0] c[1]                              || y[0] |   | r[0] |</div>
<div class="line">a[0] b[1] c[2]                         || y[1] |   | r[1] |</div>
<div class="line-block">
<div class="line">a[1] b[2] c[3]                    || y[2] |   | r[2] |</div>
<div class="line-block">
<div class="line">.    .    .                  || .    | = | .    |</div>
<div class="line-block">
<div class="line">.    .    .             || .    |   | .    |</div>
<div class="line-block">
<div class="line">.    .      c[n]   || .    |   | .    |</div>
<div class="line-block">
<div class="line">a[n-1] b[n]   || y[n] |   | r[n] |</div>
</div>
</div>
</div>
</div>
</div>
</div>
<p>for y[:].</p>
<dl class="py method">
<dt class="sig sig-object py" id="riserfit.diffusion.TridiagonalElimination.solve">
<span class="sig-name descname"><span class="pre">solve</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/riserfit/diffusion.html#TridiagonalElimination.solve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.diffusion.TridiagonalElimination.solve" title="Permalink to this definition"></a></dt>
<dd><p>Solve the matrix equation for y.</p>
<section id="id14">
<h3>Parameters:<a class="headerlink" href="#id14" title="Permalink to this heading"></a></h3>
<blockquote>
<div><p>None</p>
</div></blockquote>
</section>
<section id="id15">
<h3>Returns:<a class="headerlink" href="#id15" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>y: np.ndarray</dt><dd><p>The solution to M*y = r</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.diffusion.animate_profile_diffusion">
<span class="sig-prename descclassname"><span class="pre">riserfit.diffusion.</span></span><span class="sig-name descname"><span class="pre">animate_profile_diffusion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_nonlin_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_nonlin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([],</span> <span class="pre">dtype=float64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_opt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([],</span> <span class="pre">dtype=float64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_opt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([],</span> <span class="pre">dtype=float64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Profile'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputgif</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/riserfit/diffusion.html#animate_profile_diffusion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.diffusion.animate_profile_diffusion" title="Permalink to this definition"></a></dt>
<dd><p>Create a GIF based on a precomputed profile diffusion evolution.</p>
<section id="id16">
<h3>Parameters:<a class="headerlink" href="#id16" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>z_nonlin_matrix: np.ndarray</dt><dd><p>Profile at different time steps.</p>
</dd>
<dt>t_steps: np.ndarray</dt><dd><p>The time steps.</p>
</dd>
<dt>dx: float</dt><dd><p>Spacing between computed grid points. Used if no d_nonlin
is supplied.</p>
</dd>
<dt>d_nonlin: np.ndarray</dt><dd><p>Spacing along the calculated profile.</p>
</dd>
<dt>d_opt: np.ndarray</dt><dd><p>Optional, the original recorded profile elevations.</p>
</dd>
<dt>z_op: np.ndarray</dt><dd><p>Optional, the original recorded profile distances.</p>
</dd>
<dt>name: str</dt><dd><p>Profile name.</p>
</dd>
<dt>outputgif: bool</dt><dd><p>Whether to output the animation as a GIF.</p>
</dd>
<dt>outputname: str</dt><dd><p>The subdirectory and name of the file.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id17">
<h3>Returns:<a class="headerlink" href="#id17" title="Permalink to this heading"></a></h3>
<blockquote>
<div><p>None</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.diffusion.lin_diffusion_crank_nicolson">
<span class="sig-prename descclassname"><span class="pre">riserfit.diffusion.</span></span><span class="sig-name descname"><span class="pre">lin_diffusion_crank_nicolson</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/riserfit/diffusion.html#lin_diffusion_crank_nicolson"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.diffusion.lin_diffusion_crank_nicolson" title="Permalink to this definition"></a></dt>
<dd><p>Function to calculate the evolution of a
one-dimensional surface morphology according to the linear diffusion
equation dz/dt = k * d^2z / dx^2. This function is based on the
Crank-Nicolson method for numerically solving differential equations and
indends to archieve a compromise between stability and accuracy.</p>
<section id="id18">
<h3>Parameters:<a class="headerlink" href="#id18" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>z_init: np.ndarray</dt><dd><p>Initial elevation profile, assumed to be evenly spaced with
distances dx and boundary elevations that will not change at
z_init[0] and z_init[-1].</p>
</dd>
<dt>dx: float</dt><dd><p>Spacing between adjacent elevation values in meters,
assumed to be constant.</p>
</dd>
<dt>dt: float</dt><dd><p>Size of the time step taken, assumed to be constant. In kilo-years.</p>
</dd>
<dt>n_t: int</dt><dd><p>Number of timesteps. The oldest age will consequently be dt*n_t.</p>
</dd>
<dt>k: float</dt><dd><p>Diffusivity constant in m^2 / kyr.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id19">
<h3>Returns:<a class="headerlink" href="#id19" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>prof_matrix: np.ndarray</dt><dd><p>Matrix containing rows of profiles, first row being the initial
profile, last row being the profile at time dt*n_t.</p>
</dd>
<dt>t_steps: np.ndarray</dt><dd><p>1D array containing time steps at which the profile was calculated.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.diffusion.lin_diffusion_exp_fwd_time">
<span class="sig-prename descclassname"><span class="pre">riserfit.diffusion.</span></span><span class="sig-name descname"><span class="pre">lin_diffusion_exp_fwd_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/riserfit/diffusion.html#lin_diffusion_exp_fwd_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.diffusion.lin_diffusion_exp_fwd_time" title="Permalink to this definition"></a></dt>
<dd><p>lin_diffusion_exp_fwd_time: Function to calculate the evolution of a
one-dimensional surface morphology according to the linear diffusion
equation dz/dt = k * d^2z / dx^2. The explicit solution is calculated
forwards in time and centered in space. Boundary conditions should be given
as elevation values in z_init[0] and z_init[-1].</p>
<section id="id20">
<h3>Parameters:<a class="headerlink" href="#id20" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>z_init: np.ndarray</dt><dd><p>Initial elevation profile, assumed to be evenly spaced with
distances dx and boundary elevations that will not change at
z_init[0] and z_init[-1].</p>
</dd>
<dt>dx: float</dt><dd><p>Spacing between adjacent elevation values in meters,
assumed to be constant.</p>
</dd>
<dt>dt: float</dt><dd><p>Size of the time step taken, assumed to be constant. In kilo-years.</p>
</dd>
<dt>n_t: int</dt><dd><p>Number of timesteps. The oldest age will consequently be dt*n_t.</p>
</dd>
<dt>k: float</dt><dd><p>Diffusivity constant in m^2 / kyr.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id21">
<h3>Returns:<a class="headerlink" href="#id21" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>prof_matrix: np.ndarray</dt><dd><p>Matrix containing rows of profiles, first row being the initial
profile, last row being the profile at time dt*n_t.</p>
</dd>
<dt>t_steps: np.ndarray</dt><dd><p>1D array containing time steps at which the profile was calculated.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.diffusion.lin_diffusion_impl_backwd_time">
<span class="sig-prename descclassname"><span class="pre">riserfit.diffusion.</span></span><span class="sig-name descname"><span class="pre">lin_diffusion_impl_backwd_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/riserfit/diffusion.html#lin_diffusion_impl_backwd_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.diffusion.lin_diffusion_impl_backwd_time" title="Permalink to this definition"></a></dt>
<dd><p>Function to calculate the evolution of a one-dimensional surface
morphology according to the linear diffusion equation
dz/dt = k * d^2z / dx^2. The implicit solution is calculated
backwards in time and centered in space. Boundary conditions should be given
as elevation values in z_init[0] and z_init[-1].</p>
<section id="id22">
<h3>Parameters:<a class="headerlink" href="#id22" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>z_init: np.ndarray</dt><dd><p>Initial elevation profile, assumed to be evenly spaced with
distances dx and boundary elevations that will not change at
z_init[0] and z_init[-1].</p>
</dd>
<dt>dx: float</dt><dd><p>Spacing between adjacent elevation values in meters,
assumed to be constant.</p>
</dd>
<dt>dt: float</dt><dd><p>Size of the time step taken, assumed to be constant. In kilo-years.</p>
</dd>
<dt>n_t: int</dt><dd><p>Number of timesteps. The oldest age will consequently be dt*n_t.</p>
</dd>
<dt>k: float</dt><dd><p>Diffusivity constant in m^2 / kyr.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id23">
<h3>Returns:<a class="headerlink" href="#id23" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>prof_matrix: np.ndarray</dt><dd><p>Matrix containing rows of profiles, first row being the initial
profile, last row being the profile at time dt*n_t.</p>
</dd>
<dt>t_steps: np.ndarray</dt><dd><p>1D array containing time steps at which the profile was calculated.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.diffusion.nonlin_diff_gabet2021">
<span class="sig-prename descclassname"><span class="pre">riserfit.diffusion.</span></span><span class="sig-name descname"><span class="pre">nonlin_diff_gabet2021</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warning_eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1e-14</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/riserfit/diffusion.html#nonlin_diff_gabet2021"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.diffusion.nonlin_diff_gabet2021" title="Permalink to this definition"></a></dt>
<dd><p>Function to calculate the evolution of a
one-dimensional surface morphology according to the nonlinear diffusion
equation dz/dt = d/dx[f(x,k)dz/dx]. Where f(x,k) = k * (dz/dx)**2, as
proposed by <a class="reference external" href="https://doi.org/10.1029/2020JF005858">Gabet et al. 2021</a>
using the Q-imp scheme of Perron 2011.</p>
<section id="id24">
<h3>Parameters:<a class="headerlink" href="#id24" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>z_init: np.ndarray</dt><dd><p>Initial elevation profile, assumed to be evenly spaced with
distances dx and boundary elevations that will not change at
z_init[0] and z_init[-1].</p>
</dd>
<dt>dx: float</dt><dd><p>Spacing between adjacent elevation values in meters,
assumed to be constant.</p>
</dd>
<dt>dt: float</dt><dd><p>Size of the time step taken, assumed to be constant. In kilo-years.</p>
</dd>
<dt>n_t: int</dt><dd><p>Number of timesteps. The oldest age will consequently be dt*n_t.</p>
</dd>
<dt>k: float</dt><dd><p>Diffusivity constant in m^2 / kyr.</p>
</dd>
<dt>warning_eps: float</dt><dd><p>Print a warning if slopes get more negative than this value.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id25">
<h3>Returns:<a class="headerlink" href="#id25" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>prof_matrix: np.ndarray</dt><dd><p>Matrix containing rows of profiles, first row being the initial
profile, last row being the profile at time dt*n_t.</p>
</dd>
<dt>t_steps: np.ndarray</dt><dd><p>1D array containing time steps at which the profile was calculated.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.diffusion.nonlin_diff_perron2011">
<span class="sig-prename descclassname"><span class="pre">riserfit.diffusion.</span></span><span class="sig-name descname"><span class="pre">nonlin_diff_perron2011</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warning_eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uplift_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/riserfit/diffusion.html#nonlin_diff_perron2011"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.diffusion.nonlin_diff_perron2011" title="Permalink to this definition"></a></dt>
<dd><p>Function to calculate the evolution of a
one-dimensional surface morphology according to the nonlinear diffusion
equation dz/dt = d/dx[f(x,k)dz/dx]. Where f(x,k) = k / (1-grad(z(x))/S_c)
using the Q-imp scheme proposed by
<a class="reference external" href="https://doi.org/10.1029/2010JF001801">Perron 2011</a>.</p>
<section id="id26">
<h3>Parameters:<a class="headerlink" href="#id26" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>z_init: np.ndarray</dt><dd><p>Initial elevation profile, assumed to be evenly spaced with
distances dx and boundary elevations that will not change at
z_init[0] and z_init[-1].</p>
</dd>
<dt>dx: float</dt><dd><p>Spacing between adjacent elevation values in meters,
assumed to be constant.</p>
</dd>
<dt>dt: float</dt><dd><p>Size of the time step taken, assumed to be constant. In kilo-years.</p>
</dd>
<dt>n_t: int</dt><dd><p>Number of timesteps. The oldest age will consequently be dt*n_t.</p>
</dd>
<dt>k: float | np.array</dt><dd><p>Diffusivity constant in m^2 / kyr. If array, length
should equal the number of time steps taken.</p>
</dd>
<dt>S_c: float</dt><dd><p>Critical slope.</p>
</dd>
<dt>n: int</dt><dd><p>Exponent in the nonlinear transport term.</p>
</dd>
<dt>warning_eps: float</dt><dd><p>Print a warning message if slopes are higher than this value. Defaults to
the value of S_c.</p>
</dd>
<dt>uplift_rate: np.ndarray | float</dt><dd><p>Imposed uplift rate in m/kyr. Zero by default. If supplied as array,
len(uplift rate) == n_t must be True. No uplift is applied
at the boundaries.</p>
</dd>
<dt>rho_ratio: float</dt><dd><p>Ratio of rock density to sediment density. (Assuming that
the supplied uplift rate is a rock uplift rate, and rock
decreases in density while it is supplied to the landscape.)</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id27">
<h3>Returns:<a class="headerlink" href="#id27" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>prof_matrix: np.ndarray</dt><dd><p>Matrix containing rows of profiles, first row being the initial
profile, last row being the profile at time dt*n_t.</p>
</dd>
<dt>t_steps: np.ndarray</dt><dd><p>1D array containing time steps at which the profile was calculated.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.diffusion.nonlin_diffusion_explicit">
<span class="sig-prename descclassname"><span class="pre">riserfit.diffusion.</span></span><span class="sig-name descname"><span class="pre">nonlin_diffusion_explicit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/riserfit/diffusion.html#nonlin_diffusion_explicit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.diffusion.nonlin_diffusion_explicit" title="Permalink to this definition"></a></dt>
<dd><p>nonlin_diffusion_explicit: Function to calculate the evolution of a
one-dimensional surface morphology according to the nonlinear diffusion
equation dz/dt = d/dx[f(x,k)dz/dx]. Where f(x,k) = k / (1-grad(z(x))/S_c).</p>
<section id="id28">
<h3>Parameters:<a class="headerlink" href="#id28" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>z_init: np.ndarray</dt><dd><p>Initial elevation profile, assumed to be evenly spaced with
distances dx and boundary elevations that will not change at
z_init[0] and z_init[-1].</p>
</dd>
<dt>dx: float</dt><dd><p>Spacing between adjacent elevation values in meters,
assumed to be constant.</p>
</dd>
<dt>dt: float</dt><dd><p>Size of the time step taken, assumed to be constant. In kilo-years.</p>
</dd>
<dt>n_t: int</dt><dd><p>Number of timesteps. The oldest age will consequently be dt*n_t.</p>
</dd>
<dt>k: float</dt><dd><p>Diffusivity constant in m^2 / kyr.</p>
</dd>
<dt>S_c: float</dt><dd><p>Critical slope.</p>
</dd>
<dt>n: int</dt><dd><p>Exponent in the nonlinear transport term.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id29">
<h3>Returns:<a class="headerlink" href="#id29" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>prof_matrix: np.ndarray</dt><dd><p>Matrix containing rows of profiles, first row being the initial
profile, last row being the profile at time dt*n_t.</p>
</dd>
<dt>t_steps: np.ndarray</dt><dd><p>1D array containing time steps at which the profile was calculated.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.diffusion.nonlin_diffusion_explicit_Perron2011">
<span class="sig-prename descclassname"><span class="pre">riserfit.diffusion.</span></span><span class="sig-name descname"><span class="pre">nonlin_diffusion_explicit_Perron2011</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">z_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uplift_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rho_ratio</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/riserfit/diffusion.html#nonlin_diffusion_explicit_Perron2011"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.diffusion.nonlin_diffusion_explicit_Perron2011" title="Permalink to this definition"></a></dt>
<dd><p>nonlin_diffusion_explicit: Function to calculate the evolution of a
one-dimensional surface morphology according to the nonlinear diffusion
equation dz/dt = d/dx[f(x,k)dz/dx]. Where f(x,k) = k / (1-grad(z(x))/S_c).</p>
<section id="id30">
<h3>Parameters:<a class="headerlink" href="#id30" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>z_init: np.array</dt><dd><p>Initial elevation profile, assumed to be evenly spaced with
distances dx and boundary elevations that will not change at
z_init[0] and z_init[-1].</p>
</dd>
<dt>dx: float</dt><dd><p>Spacing between adjacent elevation values in meters,
assumed to be constant.</p>
</dd>
<dt>dt: float</dt><dd><p>Size of the time step taken, assumed to be constant. In kilo-years.</p>
</dd>
<dt>n_t: int</dt><dd><p>Number of timesteps. The oldest age will consequently be dt*n_t.</p>
</dd>
<dt>k: float</dt><dd><p>Diffusivity constant in m^2 / kyr.</p>
</dd>
<dt>S_c: float</dt><dd><p>Critical slope.</p>
</dd>
<dt>uplift_rate: float</dt><dd><p>Constant uplift rate applied to the profile.</p>
</dd>
<dt>rho_rtio: float</dt><dd><p>Ratio of bedrock to sediment density. One by default.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id31">
<h3>Returns:<a class="headerlink" href="#id31" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>prof_matrix: np.ndarray</dt><dd><p>Matrix containing rows of profiles, first row being the initial
profile, last row being the profile at time dt*n_t.</p>
</dd>
<dt>t_steps: np.ndarray</dt><dd><p>1D array containing time steps at which the profile was calculated.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

</section>
<section id="module-riserfit.profiles">
<span id="riserfit-profiles-module"></span><h2>riserfit.profiles module<a class="headerlink" href="#module-riserfit.profiles" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="riserfit.profiles.Riser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">riserfit.profiles.</span></span><span class="sig-name descname"><span class="pre">Riser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Riser: class containing geometrical information about risers (x, y, z, and
along-profile distance). Data is stored in lists to allow for an arbitrary
amount of risers to be processed at once. This class contains various
methods used for calculating riser ages.</p>
<section id="attributes">
<h3>Attributes:<a class="headerlink" href="#attributes" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>x: list[np.array]</dt><dd><p>Contains x coordinates for each profile.</p>
</dd>
<dt>y: list[np.array]</dt><dd><p>Contains y coordinates for each profile.</p>
</dd>
<dt>z: list[np.array]</dt><dd><p>Contains z coordinates for each profile.</p>
</dd>
<dt>d: list[np.array]</dt><dd><p>Contains along-profile distances for each profile.</p>
</dd>
<dt>name: list[str]</dt><dd><p>Contains names for each profile.</p>
</dd>
<dt>identifier: str</dt><dd><p>Contains string used to identify PDFs generated by class instance.</p>
</dd>
</dl>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.add_cn_ages">
<span class="sig-name descname"><span class="pre">add_cn_ages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Profile'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'avgCN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sigma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reliability</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reliability_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pd_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.add_cn_ages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.add_cn_ages" title="Permalink to this definition"></a></dt>
<dd><p>add_cn_ages: Function to associate riser profiles with available
cosmogenic nuclide (CN) ages. CN ages are loaded from a .csv
file defined by the filepath and infile.
This file should consist of at least:
#. A column containing the profile name. If the name in the
file is profileA, but profileA has been split into
profileA_0, profileA_1, etc., it will still be found and the
CN age associated with profileA will be assigned to
profileA_0, profileA_1, etc.
#. A column containing the sample (or mean sample) age.
#. A column containing CN uncertainty (1sigma or similar).
#. (Optional) A column indicating the reliability of CN
ages.</p>
<section id="id32">
<h4>Parameters:<a class="headerlink" href="#id32" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>filepath: str</dt><dd><p>Path to the folder containing a <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file with CN ages.</p>
</dd>
<dt>infile: str</dt><dd><p>Name of the <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file containing the CN ages.</p>
</dd>
<dt>name_col: str</dt><dd><p>Name of the column containing the profile names.</p>
</dd>
<dt>age_col: str</dt><dd><p>Name of the column containing the CN ages.</p>
</dd>
<dt>sigma_col: str</dt><dd><p>Name of the column containing the CN age uncertainties.</p>
</dd>
<dt>reliability: str</dt><dd><p>If some CN ages are to be treated with caution, indicate
the column name storing that information here.</p>
</dd>
<dt>reliability_dict: dict</dt><dd><p>Dictionary containing reliability information and color
for plotting, e.g.: {“y”: “blue”, “n”: “gray”}.</p>
</dd>
<dt>pd_dict: dict</dt><dd><p>Passed on to <code class="docutils literal notranslate"><span class="pre">pandas.read_csv()</span></code>.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id33">
<h4>Returns:<a class="headerlink" href="#id33" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.add_cn_terrace_ages">
<span class="sig-name descname"><span class="pre">add_cn_terrace_ages</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terrace_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'terrace'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">age_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'age'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sigma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pd_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.add_cn_terrace_ages"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.add_cn_terrace_ages" title="Permalink to this definition"></a></dt>
<dd><p>Assiociates the riserfit.Riser.terrace parameter of a
class instance with terrace ages specified in a <code class="docutils literal notranslate"><span class="pre">.csv</span></code>
file.</p>
<section id="id34">
<h4>Parameters:<a class="headerlink" href="#id34" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>filepath: str</dt><dd><p>Path to subdirectory containing .csv file.</p>
</dd>
<dt>terrace_col: str</dt><dd><p>Column name with terrace ids/names.</p>
</dd>
<dt>age_col: str</dt><dd><p>Column name with terrace ages.</p>
</dd>
<dt>sigma_col: str</dt><dd><p>Column name with terrace age standard deviations.</p>
</dd>
<dt>pd_dict: dict</dt><dd><p>Any arguments passed to <code class="docutils literal notranslate"><span class="pre">pandas.read_csv</span></code>.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id35">
<h4>Returns:<a class="headerlink" href="#id35" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.add_parameter">
<span class="sig-name descname"><span class="pre">add_parameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameter_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameter_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.add_parameter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.add_parameter" title="Permalink to this definition"></a></dt>
<dd><p>Generic function to add a new parameter to the class instance.</p>
<section id="id36">
<h4>Parameters:<a class="headerlink" href="#id36" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>parameter_name: str</dt><dd><p>The name of the new parameter.</p>
</dd>
<dt>parameter_values: list</dt><dd><p>The values (a list) of the new parameter.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id37">
<h4>Returns:<a class="headerlink" href="#id37" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.add_parameter_from_file">
<span class="sig-name descname"><span class="pre">add_parameter_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameter_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameter_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pd_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'exact'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.add_parameter_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.add_parameter_from_file" title="Permalink to this definition"></a></dt>
<dd><p>Add a new parameter from a csv file to the riser instance.</p>
<section id="id38">
<h4>Parameters:<a class="headerlink" href="#id38" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>parameter_name: str</dt><dd><p>Name of the new parameter to be added. available
as <code class="docutils literal notranslate"><span class="pre">self.parameter_name</span></code>.</p>
</dd>
<dt>filepath: str</dt><dd><p>Sub-path to CSV file.</p>
</dd>
<dt>name_col: str</dt><dd><p>Column name containing the names as they appear in
self.name</p>
</dd>
<dt>parameter_col: str</dt><dd><p>The column containing the parameter values to be added.
If None, assumed to be the same as parameter_name.</p>
</dd>
<dt>pd_dict: dict</dt><dd><p>Passed to <code class="docutils literal notranslate"><span class="pre">pandas.read_csv</span></code>.</p>
</dd>
<dt>match_type: str</dt><dd><p>Determines how the names in name_column are compared to those
in self.name. Default is “exact”, meaning that the names have
to match exactly. Alternative is “partial”, meaning that the
file names have to be contained in the riser.name names. I.e.,
a file name of “aaa” will be matched with “aaa_0” (but not
vice versa). If multiple occurences are found using either type
of matching, the first occurence is used.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id39">
<h4>Returns:<a class="headerlink" href="#id39" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.add_terrace_generation">
<span class="sig-name descname"><span class="pre">add_terrace_generation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">terrace_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pd_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.add_terrace_generation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.add_terrace_generation" title="Permalink to this definition"></a></dt>
<dd><p>Add terrace generations (names or numbers) to each riser profile.</p>
<section id="id40">
<h4>Parameters:<a class="headerlink" href="#id40" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>filepath: str</dt><dd><p>Subdirectory and filename containing a <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file with
profile names and terrace generations.</p>
</dd>
<dt>name_col: str</dt><dd><p>Column name in <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file containing profile names.</p>
</dd>
<dt>terrace_col: str</dt><dd><p>Column name in <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file containing the terrace generation.</p>
</dd>
<dt>verbose: str</dt><dd><p>Option to print status updates.</p>
</dd>
<dt>pd_dict: dict</dt><dd><p>Any options passed on to <code class="docutils literal notranslate"><span class="pre">pandas.read_csv</span></code>.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id41">
<h4>Returns:<a class="headerlink" href="#id41" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.apply_d_z_offsets">
<span class="sig-name descname"><span class="pre">apply_d_z_offsets</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.apply_d_z_offsets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.apply_d_z_offsets" title="Permalink to this definition"></a></dt>
<dd><p>Function to recalculate d, z using the best fit
offsets determined by the linear diffusion fit.</p>
<section id="id42">
<h4>Parameters:<a class="headerlink" href="#id42" title="Permalink to this heading"></a></h4>
<blockquote>
<div><p>None</p>
</div></blockquote>
</section>
<section id="id43">
<h4>Returns:<a class="headerlink" href="#id43" title="Permalink to this heading"></a></h4>
<blockquote>
<div><p>None</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.azimuth">
<span class="sig-name descname"><span class="pre">azimuth</span></span><a class="headerlink" href="#riserfit.profiles.Riser.azimuth" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which compute_azimuth() stores results.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.best_a">
<span class="sig-name descname"><span class="pre">best_a</span></span><a class="headerlink" href="#riserfit.profiles.Riser.best_a" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which compute_best_linear_diffusion_fit() stores best riser height.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.best_b">
<span class="sig-name descname"><span class="pre">best_b</span></span><a class="headerlink" href="#riserfit.profiles.Riser.best_b" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which compute_best_linear_diffusion_fit() stores best far-field gradient.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.best_d_off">
<span class="sig-name descname"><span class="pre">best_d_off</span></span><a class="headerlink" href="#riserfit.profiles.Riser.best_d_off" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which compute_best_linear_diffusion_fit() stores d offset.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.best_kt">
<span class="sig-name descname"><span class="pre">best_kt</span></span><a class="headerlink" href="#riserfit.profiles.Riser.best_kt" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which compute_best_linear_diffusion_fit() stores kt.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.best_midpoint_grad">
<span class="sig-name descname"><span class="pre">best_midpoint_grad</span></span><a class="headerlink" href="#riserfit.profiles.Riser.best_midpoint_grad" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which compute_best_linear_diffusion_fit() stores gradient at midpoint.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.best_misfit">
<span class="sig-name descname"><span class="pre">best_misfit</span></span><a class="headerlink" href="#riserfit.profiles.Riser.best_misfit" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which compute_best_linear_diffusion_fit() stores RMSE.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.best_theta">
<span class="sig-name descname"><span class="pre">best_theta</span></span><a class="headerlink" href="#riserfit.profiles.Riser.best_theta" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which compute_best_linear_diffusion_fit() stores best intitial slope.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.best_z_off">
<span class="sig-name descname"><span class="pre">best_z_off</span></span><a class="headerlink" href="#riserfit.profiles.Riser.best_z_off" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which compute_best_linear_diffusion_fit() stores z offset.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.build_Riser_instance_dataframe">
<span class="sig-name descname"><span class="pre">build_Riser_instance_dataframe</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.build_Riser_instance_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.build_Riser_instance_dataframe" title="Permalink to this definition"></a></dt>
<dd><p>Creates a pandas dataframe containing data attributes of the Riser
class instance. Only contains data that is stored as single string or
numeric values for each profile.</p>
<section id="id44">
<h4>Parameters:<a class="headerlink" href="#id44" title="Permalink to this heading"></a></h4>
<blockquote>
<div><p>None</p>
</div></blockquote>
</section>
<section id="id45">
<h4>Returns:<a class="headerlink" href="#id45" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>df: pd.DataFrame</dt><dd><p>Output dataframe.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.calculate_kt_uncertainty">
<span class="sig-name descname"><span class="pre">calculate_kt_uncertainty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iteration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">summarypdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ascending</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.calculate_kt_uncertainty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.calculate_kt_uncertainty" title="Permalink to this definition"></a></dt>
<dd><p>Calculates uncertainties in linear kt. Analogous to
<a class="reference external" href="https://doi.org/10.1016/j.jseaes.2015.02.016">Wei et al. 2015</a>.</p>
<section id="id46">
<h4>Parameters:<a class="headerlink" href="#id46" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>dt: float</dt><dd><p>Step size when searching for inversion bounds on kt.</p>
</dd>
<dt>max_iteration: int</dt><dd><p>Maximum number of iterations when searching for
the inversion bounds in kt.</p>
</dd>
<dt>summarypdf: bool</dt><dd><p>Option to plot all diffusion ages against profile name,
including uncertainty.</p>
</dd>
<dt>ascending: bool</dt><dd><p>Option to plot ages in ascending order.</p>
</dd>
<dt>verbose: bool</dt><dd><p>Option to print results to console output.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id47">
<h4>Returns:<a class="headerlink" href="#id47" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.calculate_nonlin_t_uncertainty">
<span class="sig-name descname"><span class="pre">calculate_nonlin_t_uncertainty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warning_eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iteration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">summarypdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.calculate_nonlin_t_uncertainty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.calculate_nonlin_t_uncertainty" title="Permalink to this definition"></a></dt>
<dd><p>Calculate uncertainty bounds for
nonlinear age. Analogous to
<a class="reference external" href="https://doi.org/10.1016/j.jseaes.2015.02.016">Wei et al. 2015</a>.</p>
<section id="id49">
<h4>Parameters:<a class="headerlink" href="#id49" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>k: float</dt><dd><p>Nonlinear diffusion coefficient</p>
</dd>
<dt>S_c: float</dt><dd><p>Critical slope.</p>
</dd>
<dt>n: int</dt><dd><p>Exponent in the nonlinear diffusion equation.</p>
</dd>
<dt>dt: float</dt><dd><p>Time step for diffusion model.</p>
</dd>
<dt>warning_eps: float</dt><dd><p>Raise warning if slopes of the modelled profiles
are smaller than warning_eps.</p>
</dd>
<dt>max_iteration: int</dt><dd><p>How far ahead t are computed when searching for the upper
uncertainty bound. The upper limit is determined by
dt*max_iteration</p>
</dd>
<dt>summarypdf: bool</dt><dd><p>Option to plot all diffusion ages against profile name,
including uncertainty.</p>
</dd>
<dt>verbose: bool</dt><dd><p>Option to print results to console output.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id50">
<h4>Returns:<a class="headerlink" href="#id50" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.calculate_parameter_uncertainties">
<span class="sig-name descname"><span class="pre">calculate_parameter_uncertainties</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.4901161193847656e-08</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.calculate_parameter_uncertainties"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.calculate_parameter_uncertainties" title="Permalink to this definition"></a></dt>
<dd><p>Calculates confidence bands by treating the parameter estimation
as a nonlinear regression problem
(<a class="reference external" href="https://www.youtube.com/watch?v=3IgIToOV2Wk">see here</a>).
Results are stored in self.parameter_uncertainties.</p>
<section id="id51">
<h4>Parameters:<a class="headerlink" href="#id51" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>epsilon: Union[ArrayLike, float]</dt><dd><p>The epsilon (delta value) used for calculating
derivatives numerically.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id52">
<h4>Returns:<a class="headerlink" href="#id52" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.calculate_upstream_distance">
<span class="sig-name descname"><span class="pre">calculate_upstream_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">riverpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lower'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'x'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'y'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_dist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'distance'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">invert_distances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.calculate_upstream_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.calculate_upstream_distance" title="Permalink to this definition"></a></dt>
<dd><p>Takes a <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file containing points describing a river path and calculates
the along-stream distance for each Riser profile (based on the first or last
point of each profile).</p>
<section id="id53">
<h4>Parameters:<a class="headerlink" href="#id53" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>riverpath: str</dt><dd><p>Path to <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file containing <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> points describing the
river path.</p>
</dd>
<dt>df_x: str</dt><dd><p>Name of the <code class="docutils literal notranslate"><span class="pre">.csv</span></code> column containing the <code class="docutils literal notranslate"><span class="pre">x</span></code> coordinate.</p>
</dd>
<dt>df_y: str</dt><dd><p>Name of the <code class="docutils literal notranslate"><span class="pre">.csv</span></code> column containing the <code class="docutils literal notranslate"><span class="pre">y</span></code> coordinate.</p>
</dd>
<dt>df_dist: str</dt><dd><p>Name of the column containing the distances between points along,
the river line, if already calculated. Set to <code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code> if
not present in <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file.</p>
</dd>
<dt>invert_distances: bool</dt><dd><p>Option to flip the points. Will calculate distances in the
opposite way.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id54">
<h4>Returns:<a class="headerlink" href="#id54" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.cn_age">
<span class="sig-name descname"><span class="pre">cn_age</span></span><a class="headerlink" href="#riserfit.profiles.Riser.cn_age" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which add_cn_ages() stores ages.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.cn_age_reliability">
<span class="sig-name descname"><span class="pre">cn_age_reliability</span></span><a class="headerlink" href="#riserfit.profiles.Riser.cn_age_reliability" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which cn_age_sigma() stores a reliability indicator.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.cn_age_sigma">
<span class="sig-name descname"><span class="pre">cn_age_sigma</span></span><a class="headerlink" href="#riserfit.profiles.Riser.cn_age_sigma" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which cn_age_sigma() stores uncertainty.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.compute_azimuth">
<span class="sig-name descname"><span class="pre">compute_azimuth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.compute_azimuth"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.compute_azimuth" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the profile orientation relative to north.</p>
<section id="id55">
<h4>Parameters:<a class="headerlink" href="#id55" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>rad: bool</dt><dd><p>Angles are returned in rad. If False, returned in
degrees.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id56">
<h4>Returns:<a class="headerlink" href="#id56" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.compute_best_linear_diffusion_fit">
<span class="sig-name descname"><span class="pre">compute_best_linear_diffusion_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">init_kt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_d_off</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_z_off</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kt_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0,</span> <span class="pre">10000)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0,</span> <span class="pre">None)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.4,</span> <span class="pre">0.4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_off_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(-20,</span> <span class="pre">20)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_off_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(-10,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">summarypdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warning_eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1e-10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.compute_best_linear_diffusion_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.compute_best_linear_diffusion_fit" title="Permalink to this definition"></a></dt>
<dd><p>Uses scipy’s <code class="docutils literal notranslate"><span class="pre">optimize.minimize</span></code> to
compute a set of parameters leading to a best fit between the analytical
linear diffusion profile and the measured profile defined by self.d and
self.z. Initial guesses may be user defined and can lead to
significantly different results. Initial guesses should not equal zero.</p>
<section id="id57">
<h4>Parameters:<a class="headerlink" href="#id57" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>init_kt: float</dt><dd><p>Initial guess for diffusion age.</p>
</dd>
<dt>init_a:</dt><dd><p>Initial guess for the riser height. By default (None) computed
as <code class="docutils literal notranslate"><span class="pre">(self.z[i].max()</span> <span class="pre">-</span> <span class="pre">self.z[i].min())</span> <span class="pre">/</span> <span class="pre">2</span></code>.</p>
</dd>
<dt>init_b: float</dt><dd><p>Initial guess for the far field gradient.</p>
</dd>
<dt>init_theta: float</dt><dd><p>Initial value for the initial gradient at the riser midpoint and
age zero. This value can only be robustly estimated for some
risers, especially those that have retained a slope of theta
around their midpoints. For other risers, this value can vary
drastically.</p>
</dd>
<dt>init_d_off: float</dt><dd><p>Initial guess for the offset in along-profile (horizontal)
direction.</p>
</dd>
<dt>init_z_off: float</dt><dd><p>Initial guess for the offset in elevation (vertical) direction.</p>
</dd>
<dt>kt_range: tuple</dt><dd><p>Bounds of diffusion ange range to be considered by the
optimization alogrithm.</p>
</dd>
<dt>a_range: tuple</dt><dd><p>Bounds of the (half) riser height to be considered by the
optimization algorithm.</p>
</dd>
<dt>b_range: tuple</dt><dd><p>Bounds of the far field gradient to be considered by the
optimization algorithm.</p>
</dd>
<dt>theta_range: tuple</dt><dd><p>Bounds for the initial slope to be considered by the optimization
algorithm.</p>
</dd>
<dt>d_off_range: tuple</dt><dd><p>Bounds of the offset in along-profile (horizontal) direction to
be considered by the optimization algorithm.</p>
</dd>
<dt>z_off_range: tuple</dt><dd><p>Bounds of the offset in elevation (vertical) direction to be
considered by the optimization algorithm.</p>
</dd>
<dt>summarypdf: bool</dt><dd><p>Option to create a summary PDF containing best fits for each
profile.</p>
</dd>
<dt>verbose: bool</dt><dd><p>Option to print the best fit parameters to the console.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id58">
<h4>Returns:<a class="headerlink" href="#id58" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.compute_best_nonlinear_diffusion_fit">
<span class="sig-name descname"><span class="pre">compute_best_nonlinear_diffusion_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S_c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cubic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warning_eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1e-14</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_tz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">summarypdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.compute_best_nonlinear_diffusion_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.compute_best_nonlinear_diffusion_fit" title="Permalink to this definition"></a></dt>
<dd><p>compute_best_nonlinear_diffusion_fit: Calculate the best-fit age for
all profiles contained in the Riser instance. Assumes that <code class="docutils literal notranslate"><span class="pre">S_c</span></code> and <code class="docutils literal notranslate"><span class="pre">k</span></code>
do not vary between profiles. This method uses the implicit scheme
based on Perron (2011).</p>
<section id="id59">
<h4>Parameters:<a class="headerlink" href="#id59" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>t_range: list</dt><dd><p>List of age boundary tuples. If list is empty,
upper boundaries are set to self.best_kt[i]*2.</p>
</dd>
<dt>k: float</dt><dd><p>Diffusivity constant in the nonlinear diffusion equation,
in m^2 / kyr</p>
</dd>
<dt>S_c: float</dt><dd><p>Critical hillslope gradient.</p>
</dd>
<dt>init_dt: float</dt><dd><p>Time step size for the implicit nonlinear diffusion scheme.</p>
</dd>
<dt>interp_dx: float</dt><dd><p>Resolution size for the profile grid used in the implicit
scheme. Smaller dx will increase computation time, but avoid
interpolation errors when comparing the modelled profile to the
measured profile.</p>
</dd>
<dt>warning_eps: float</dt><dd><p>If calculated slope is less than warning_eps, warning is raised.
Necessary, because negative slopes occur due to floating point
errors.</p>
</dd>
<dt>save_tz: bool</dt><dd><p>Option to save t and z at every timestep of the numerical modeling.
May result in significantly larger memory usage.</p>
</dd>
<dt>interp_method: str or float</dt><dd><p>Method used for interpolating the modelled profile to the points
where elevation was measured. See scipy’s interp1d for details.</p>
</dd>
<dt>summarypdf: bool</dt><dd><p>Option to print a summmary pdf containing age estimates for each
profile.</p>
</dd>
<dt>verbose: bool</dt><dd><p>Option to print process updates to the console while ages are
calculated.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id60">
<h4>Returns:<a class="headerlink" href="#id60" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.compute_best_nonlinear_diffusion_fit_general">
<span class="sig-name descname"><span class="pre">compute_best_nonlinear_diffusion_fit_general</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">diffusion_law</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_arg_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interp_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cubic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">summarypdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.compute_best_nonlinear_diffusion_fit_general"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.compute_best_nonlinear_diffusion_fit_general" title="Permalink to this definition"></a></dt>
<dd><p>Function that takes any differentiable diffusion law, in form
equal to <code class="docutils literal notranslate"><span class="pre">riserfit.nonlin_diff_perron2011</span></code>
and performs a fitting routine.
Any special arguments of the diffusion law (e.g., critical
slope) are supplied in the diff_arg_dict dictionary.</p>
<section id="id61">
<h4>Parameters:<a class="headerlink" href="#id61" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>diffusion_law: callable</dt><dd><p>A function like <code class="docutils literal notranslate"><span class="pre">riserfit.nonlin_diff_perron2011</span></code> that
calculates the diffusion of a riser profile and outputs
a <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code> containing elevation values of every time step
and a second <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code> containing the cumulative time of the
time steps.
The function must at minimum take initial elevations,
dx, dt, number of time steps, and k as inputs. Any
additional parameters may be passed by <code class="docutils literal notranslate"><span class="pre">diff_arg_dict</span></code>.</p>
</dd>
<dt>t_range: list</dt><dd><p>List of upper t boundaries for each profile.</p>
</dd>
<dt>k: float</dt><dd><p>The diffusivity constant of the nonlinear diffusion model.</p>
</dd>
<dt>init_dt: float</dt><dd><p>Size of the time step used for numerical calculations.</p>
</dd>
<dt>interp_dx: float</dt><dd><p>Distance between z grid nodes of the modelled profile.</p>
</dd>
<dt>diff_arg_dict: dict</dt><dd><p>Additional arguments passed on to diffusion_law.</p>
</dd>
<dt>interp_method:</dt><dd><p>Interpolation method used in scipy.interpolate.interp1d.</p>
</dd>
<dt>summarypdf: bool</dt><dd><p>Option to compile a summary PDF.</p>
</dd>
<dt>verbose: bool</dt><dd><p>Option to print status messages to the console.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id62">
<h4>Returns:<a class="headerlink" href="#id62" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.compute_gradients">
<span class="sig-name descname"><span class="pre">compute_gradients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">summarypdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.compute_gradients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.compute_gradients" title="Permalink to this definition"></a></dt>
<dd><p>compute_gradients: Function to compute the numerical gradient for each
profile point based on the along-profile distance d and elevation z.
The centered derivative is calculated for all points except for the
first and last one. For the latter, the forwards/backwards derivative is
calculated instead.</p>
<section id="id63">
<h4>Parameters:<a class="headerlink" href="#id63" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>summarypdf: bool</dt><dd><p>Option to create a PDF in the working directory.</p>
</dd>
<dt>verbose: bool</dt><dd><p>Option to output a message when creating PDF.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id64">
<h4>Returns:<a class="headerlink" href="#id64" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.compute_symmetry_index">
<span class="sig-name descname"><span class="pre">compute_symmetry_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">summarypdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.compute_symmetry_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.compute_symmetry_index" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the RMSE between the lower and upper “legs” of the
riser. The midpoint, or point of rotation, is defined at d=0.</p>
<section id="id65">
<h4>Parameters:<a class="headerlink" href="#id65" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>summarypdf: bool</dt><dd><p>Whether to output a PDF containing symmetry index results.</p>
</dd>
<dt>verbose: bool</dt><dd><p>Whether to print symmetry indices to the console.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id66">
<h4>Returns:<a class="headerlink" href="#id66" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.construct_StatsMC_instance">
<span class="sig-name descname"><span class="pre">construct_StatsMC_instance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kt_parameter_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'best_kt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kt_lb_parameter_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lower_kt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kt_ub_parameter_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'upper_kt'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_parameter_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cn_age'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_sigma_parameter_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cn_age_sigma'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.construct_StatsMC_instance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.construct_StatsMC_instance" title="Permalink to this definition"></a></dt>
<dd><p>This function return a tuple of <code class="docutils literal notranslate"><span class="pre">StatsMC</span></code> instances. How many instances
are created depends on the number of different entries in the
<code class="docutils literal notranslate"><span class="pre">t_parameter_name</span></code> list. I.e., if all risers have the same age,
only one instance is returned.
If any risers have the entry np.nan associated, they are grouped into
their own <code class="docutils literal notranslate"><span class="pre">StatsMC</span></code> entry and take up the last position in the returned
tuple.</p>
<section id="id67">
<h4>Parameters:<a class="headerlink" href="#id67" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>kt_parameter_name: str</dt><dd><p>Determines whether to use linear or nonlinear diffusion, so
should be either “best_kt” (for linear diffusion) or
“nonlin_best_t” (for nonlinear diffusion). Default is linear
diffusion.</p>
</dd>
<dt>kt_lb_parameter_name: str</dt><dd><p>Determines if bounds from linear or nonlinear diffusion are
to be used. Default is “lower_kt” (linear diffusion)l
alternative is “nonlin_lower_t” (nonlinear diffusion).</p>
</dd>
<dt>kt_ub_parameter_name: str</dt><dd><p>Determines if bounds from linear or nonlinear diffusion are
to be used. Default is “upper_kt” (linear diffusion)
alternative is “nonlin_upper_t” (nonlinear diffusion).</p>
</dd>
<dt>t_parameter_name: str</dt><dd><p>Parameter storing age information. This can also be an array
of length <code class="docutils literal notranslate"><span class="pre">n</span></code> for each riser, indicating that there are multiple
available ages to be used. If so, the t PDF used for MC
simulations will be a composite Gaussian distribution. Default
is “cn_age”.
The data stored in <code class="docutils literal notranslate"><span class="pre">getattr(self,</span> <span class="pre">t_parameter_name)[i]</span></code> needs to
be either a numerical value (float, …) or a <code class="docutils literal notranslate"><span class="pre">np.array</span></code>. Lists
are not supported.</p>
</dd>
<dt>t_sigma_parameter_name: str</dt><dd><p>Parameter storing the uncertainty information associated with
each entry in <code class="docutils literal notranslate"><span class="pre">t_parameter_name</span></code>. These entries must have the same
format as those in <code class="docutils literal notranslate"><span class="pre">t_parameter_name</span></code>. I.e., if the latter is
an array of length n for a single riser, the corresponding
information in <code class="docutils literal notranslate"><span class="pre">t_sigma_parameter_name</span></code> also needs to be an
array of length <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
</dd>
<dt>identifier: str</dt><dd><p>Set the <code class="docutils literal notranslate"><span class="pre">StatsMC.identifier</span></code> property of the created instance.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">Riser.indentifier</span></code> is used.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id68">
<h4>Returns:<a class="headerlink" href="#id68" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>statsMC: Tuple</dt><dd><p>A length <code class="docutils literal notranslate"><span class="pre">n</span></code> tuple containing instances of <code class="docutils literal notranslate"><span class="pre">riserfit.StatsMC</span></code>.
If some risers do not have an age assigned, they are grouped
in the last returned <code class="docutils literal notranslate"><span class="pre">StatsMC</span></code> instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.extract_profile_elevation">
<span class="sig-name descname"><span class="pre">extract_profile_elevation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rasterpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_no</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">surface</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lower'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">rio_open_params</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.extract_profile_elevation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.extract_profile_elevation" title="Permalink to this definition"></a></dt>
<dd><p>Extract profile elevations using a DEM or REM. Depending on the value
of surface, the first or last point of each profile is used to calculate
the profile elevation.</p>
<section id="id69">
<h4>Parameters:<a class="headerlink" href="#id69" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>rasterpath: str</dt><dd><p>Path to file containing a raster with river-relative elevations</p>
</dd>
<dt>band_no: int</dt><dd><p>Band containing elevation.</p>
</dd>
<dt>surface: str</dt><dd><p>Extract elevation from the ‘upper’ or ‘lower’ terrace surface.</p>
</dd>
<dt>method: str</dt><dd><p>Interpolation method used to extract relative elevations. Can
take any value allowed by <code class="docutils literal notranslate"><span class="pre">scipy.interpolate.interpn()</span></code>.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id70">
<h4>Returns:<a class="headerlink" href="#id70" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.extract_subset">
<span class="sig-name descname"><span class="pre">extract_subset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">profiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#riserfit.profiles.Riser" title="riserfit.profiles.Riser"><span class="pre">Riser</span></a></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.extract_subset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.extract_subset" title="Permalink to this definition"></a></dt>
<dd><p>extract_subset: Function to construct a new Riser class object with
a subset of profiles from the original class instance.  All attributes of the original
instance are preserved.</p>
<p>The extraction process is limited to attributes of len(self.name).</p>
<section id="id71">
<h4>Parameters:<a class="headerlink" href="#id71" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>profiles: list of int or str</dt><dd><p>List containing either the index positions or names of profiles
to be subset.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id72">
<h4>Returns:<a class="headerlink" href="#id72" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>new_riser: Riser</dt><dd><p>A new Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.flip_profile_orientation">
<span class="sig-name descname"><span class="pre">flip_profile_orientation</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.flip_profile_orientation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.flip_profile_orientation" title="Permalink to this definition"></a></dt>
<dd><p>Function to ensure that each d and z are ordered such
that d[0] &lt; d[-1] and z[0] &lt; z[-1]. Also reverses the ordering
in x and y. This is important for symmetry calculations and
general data fitting.</p>
<section id="id73">
<h4>Parameters:<a class="headerlink" href="#id73" title="Permalink to this heading"></a></h4>
<blockquote>
<div><p>None</p>
</div></blockquote>
</section>
<section id="id74">
<h4>Returns:<a class="headerlink" href="#id74" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.gradient">
<span class="sig-name descname"><span class="pre">gradient</span></span><a class="headerlink" href="#riserfit.profiles.Riser.gradient" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which compute_gradients() stores results.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.jack_a">
<span class="sig-name descname"><span class="pre">jack_a</span></span><a class="headerlink" href="#riserfit.profiles.Riser.jack_a" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which jackknife_linear_diffusion_fit() stores riser heights.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.jack_b">
<span class="sig-name descname"><span class="pre">jack_b</span></span><a class="headerlink" href="#riserfit.profiles.Riser.jack_b" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which jackknife_linear_diffusion_fit() stores far-field slopes.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.jack_d">
<span class="sig-name descname"><span class="pre">jack_d</span></span><a class="headerlink" href="#riserfit.profiles.Riser.jack_d" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which jackknife_linear_diffusion_fit() stores distances.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.jack_d_off">
<span class="sig-name descname"><span class="pre">jack_d_off</span></span><a class="headerlink" href="#riserfit.profiles.Riser.jack_d_off" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which jackknife_linear_diffusion_fit() stores d offsets.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.jack_kt">
<span class="sig-name descname"><span class="pre">jack_kt</span></span><a class="headerlink" href="#riserfit.profiles.Riser.jack_kt" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which jackknife_linear_diffusion_fit() stores kt.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.jack_midpoint_gradient">
<span class="sig-name descname"><span class="pre">jack_midpoint_gradient</span></span><a class="headerlink" href="#riserfit.profiles.Riser.jack_midpoint_gradient" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which jackknife_linear_diffusion_fit() stores midpoint gradients.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.jack_misfit">
<span class="sig-name descname"><span class="pre">jack_misfit</span></span><a class="headerlink" href="#riserfit.profiles.Riser.jack_misfit" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which jackknife_linear_diffusion_fit() stores RMSE.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.jack_optimize_summary">
<span class="sig-name descname"><span class="pre">jack_optimize_summary</span></span><a class="headerlink" href="#riserfit.profiles.Riser.jack_optimize_summary" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which jackknife_linear_diffusion_fit() stores optimisation summaries.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.jack_z">
<span class="sig-name descname"><span class="pre">jack_z</span></span><a class="headerlink" href="#riserfit.profiles.Riser.jack_z" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which jackknife_linear_diffusion_fit() stores elevations.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.jack_z_off">
<span class="sig-name descname"><span class="pre">jack_z_off</span></span><a class="headerlink" href="#riserfit.profiles.Riser.jack_z_off" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which jackknife_linear_diffusion_fit() stores z offsets.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.jackknife_linear_diffusion_fit">
<span class="sig-name descname"><span class="pre">jackknife_linear_diffusion_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fraction_reduction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">every_kth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">summarypdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warning_eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1e-10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lin_diff_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.jackknife_linear_diffusion_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.jackknife_linear_diffusion_fit" title="Permalink to this definition"></a></dt>
<dd><p>Calculates a range of kt and other parameters for linear diffusion
based on a profile consisting only of a subset of points from
the original profile.</p>
<section id="id75">
<h4>Parameters:<a class="headerlink" href="#id75" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>iterations: int</dt><dd><p>The number of resamples undertaken for each profile.</p>
</dd>
<dt>fraction_reduction: float</dt><dd><p>Fraction of points to be left out of the subset.</p>
</dd>
<dt>every_kth: int</dt><dd><p>If larger than 0, used for sampling points.</p>
</dd>
<dt>verbose: bool</dt><dd><p>Option to print progress statements to console.</p>
</dd>
<dt>summarypdf: bool</dt><dd><p>Print a PDF showing jackknifing histograms.</p>
</dd>
<dt>lin_diff_dict: dict</dt><dd><p>Additional arguments passed to
<code class="docutils literal notranslate"><span class="pre">Riser.compute_best_linear_diffusion_fit()</span></code>.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id76">
<h4>Returns:<a class="headerlink" href="#id76" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.jackknife_nonlinear_diffusion_fit">
<span class="sig-name descname"><span class="pre">jackknife_nonlinear_diffusion_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterations</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fraction_reduction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">summarypdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlin_diff_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.jackknife_nonlinear_diffusion_fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.jackknife_nonlinear_diffusion_fit" title="Permalink to this definition"></a></dt>
<dd><p>Calculates a range of kt and other parameters for nonlinear diffusion
based on a profile consisting only of a subset of points from
the original profile.</p>
<section id="id77">
<h4>Parameters:<a class="headerlink" href="#id77" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>iterations: int</dt><dd><p>The number of resamples undertaken for each profile.</p>
</dd>
<dt>fraction_reduction: float</dt><dd><p>Fraction of points to be removed  from the set of points.</p>
</dd>
<dt>verbose: bool</dt><dd><p>Option to print progress statements to console.</p>
</dd>
<dt>summarypdf: bool</dt><dd><p>Print a PDF showing jackknifing histograms.</p>
</dd>
<dt>nonlin_diff_dict: dict</dt><dd><p>Additional arguments passed to
<code class="docutils literal notranslate"><span class="pre">Riser.compute_best_nonlinear_diffusion_fit()</span></code>.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id78">
<h4>Returns:<a class="headerlink" href="#id78" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.lower_kt">
<span class="sig-name descname"><span class="pre">lower_kt</span></span><a class="headerlink" href="#riserfit.profiles.Riser.lower_kt" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which calculate_kt_uncertainty() stores a lower bound.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.merge_Riser_instances">
<span class="sig-name descname"><span class="pre">merge_Riser_instances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">riser_instance_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.merge_Riser_instances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.merge_Riser_instances" title="Permalink to this definition"></a></dt>
<dd><p>Appends the information stored in other Riser instances in the Riser instance
that calls this function. Only affects information stored in list type.</p>
<section id="id79">
<h4>Parameters:<a class="headerlink" href="#id79" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>riser_instance_list: list</dt><dd><p>List of other Riser instances to be merged into self.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id80">
<h4>Returns:<a class="headerlink" href="#id80" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>A Riser instance containing the merged instances.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.mirror_upper_profile_half">
<span class="sig-name descname"><span class="pre">mirror_upper_profile_half</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">apply_to_selection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symmetry_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">summarypdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.mirror_upper_profile_half"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.mirror_upper_profile_half" title="Permalink to this definition"></a></dt>
<dd><p>This method takes the upper half of each riser profile
(defined by d&gt;0) and rotates it in such a way that it
replaces the lower half of the profile. This is
equivalent to a rotation of 180° around the coordinate
origin. By default, it is applied to all profiles with a
symmetry index greater than 4.5.</p>
<section id="id81">
<h4>Parameters:<a class="headerlink" href="#id81" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>apply_to_selection: list</dt><dd><p>If not None (default), a list of length equal to number
of profiles containing True/False entries.
If entry is True, the profile corresponding to the index
is mirrored.</p>
</dd>
<dt>symmetry_threshold: float</dt><dd><p>All profiles with a SE greater than the threshold are
mirrored. Set to 0.</p>
</dd>
<dt>summarypdf: bool</dt><dd><p>Option to print a summary PDF.</p>
</dd>
<dt>verbose: bool</dt><dd><p>Print status updates.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id82">
<h4>Returns:<a class="headerlink" href="#id82" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.nonlin_best_mf">
<span class="sig-name descname"><span class="pre">nonlin_best_mf</span></span><a class="headerlink" href="#riserfit.profiles.Riser.nonlin_best_mf" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which compute_best_nonlinear_diffusion_fit() stores RMSE.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.nonlin_best_t">
<span class="sig-name descname"><span class="pre">nonlin_best_t</span></span><a class="headerlink" href="#riserfit.profiles.Riser.nonlin_best_t" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which compute_best_nonlinear_diffusion_fit() stores best t.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.nonlin_best_z">
<span class="sig-name descname"><span class="pre">nonlin_best_z</span></span><a class="headerlink" href="#riserfit.profiles.Riser.nonlin_best_z" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which compute_best_nonlinear_diffusion_fit() stores best-fit z matching self.d.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.nonlin_d">
<span class="sig-name descname"><span class="pre">nonlin_d</span></span><a class="headerlink" href="#riserfit.profiles.Riser.nonlin_d" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which compute_best_nonlinear_diffusion_fit() stores optimisation result.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.nonlin_dt">
<span class="sig-name descname"><span class="pre">nonlin_dt</span></span><a class="headerlink" href="#riserfit.profiles.Riser.nonlin_dt" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which compute_best_nonlinear_diffusion_fit() stores used dt.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.nonlin_jack_best_t">
<span class="sig-name descname"><span class="pre">nonlin_jack_best_t</span></span><a class="headerlink" href="#riserfit.profiles.Riser.nonlin_jack_best_t" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which jackknife_nonlinear_diffusion_fit() stores t.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.nonlin_lower_t">
<span class="sig-name descname"><span class="pre">nonlin_lower_t</span></span><a class="headerlink" href="#riserfit.profiles.Riser.nonlin_lower_t" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which calculate_nonlin_t_uncertainty() stores lower bounds.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.nonlin_opt_sum">
<span class="sig-name descname"><span class="pre">nonlin_opt_sum</span></span><a class="headerlink" href="#riserfit.profiles.Riser.nonlin_opt_sum" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which compute_best_nonlinear_diffusion_fit() stores optimisation result.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.nonlin_t_times">
<span class="sig-name descname"><span class="pre">nonlin_t_times</span></span><a class="headerlink" href="#riserfit.profiles.Riser.nonlin_t_times" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which compute_best_nonlinear_diffusion_fit() stores all computed time steps.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.nonlin_upper_t">
<span class="sig-name descname"><span class="pre">nonlin_upper_t</span></span><a class="headerlink" href="#riserfit.profiles.Riser.nonlin_upper_t" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which calculate_nonlin_t_uncertainty() stores upper bounds.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.nonlin_z_matrix">
<span class="sig-name descname"><span class="pre">nonlin_z_matrix</span></span><a class="headerlink" href="#riserfit.profiles.Riser.nonlin_z_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which compute_best_nonlinear_diffusion_fit() stores z profiles at time steps dt.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.optimize_summary">
<span class="sig-name descname"><span class="pre">optimize_summary</span></span><a class="headerlink" href="#riserfit.profiles.Riser.optimize_summary" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which compute_best_linear_diffusion_fit() stores optimisation result.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.plot_profile_map">
<span class="sig-name descname"><span class="pre">plot_profile_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rasterpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_no</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diffusion_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dem_min</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dem_max</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">410</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">annotate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.plot_profile_map"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.plot_profile_map" title="Permalink to this definition"></a></dt>
<dd><p>Function to plot profiles onto a DEM (must have the same projection!).
Plot lines are colored according to kt (linear or nonlinear).</p>
<section id="id83">
<h4>Parameters:<a class="headerlink" href="#id83" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>rasterpath: str</dt><dd><p>Subdirectory and filename of the DEM</p>
</dd>
<dt>band_no: int</dt><dd><p>Number of band containing elevations. Default is 1.</p>
</dd>
<dt>diffusion_type: str</dt><dd><p>“linear” or “nonlinear”, decides the kt to use to color
profiles on the map.</p>
</dd>
<dt>dem_min: float</dt><dd><p>Lower limit of the color map.</p>
</dd>
<dt>dem_max: float</dt><dd><p>Upper limit of the color map.</p>
</dd>
<dt>annotate: bool</dt><dd><p>Whether to display profile names on the map.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id84">
<h4>Returns:<a class="headerlink" href="#id84" title="Permalink to this heading"></a></h4>
<blockquote>
<div><p>None</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.profile_elevation">
<span class="sig-name descname"><span class="pre">profile_elevation</span></span><a class="headerlink" href="#riserfit.profiles.Riser.profile_elevation" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which extract_profile_elevation() stores an absolute elevation value.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.resample_raster_along_profiles">
<span class="sig-name descname"><span class="pre">resample_raster_along_profiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rasterpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band_no</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autocenter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savedir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.resample_raster_along_profiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.resample_raster_along_profiles" title="Permalink to this definition"></a></dt>
<dd><p>Resample elevation values of all profiles in Riser instance using data
from a DEM in rasterpath.</p>
<section id="id85">
<h4>Parameters:<a class="headerlink" href="#id85" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>rasterpath: str</dt><dd><p>Path to subdirectory containing the DEM in a format accepted
by <code class="docutils literal notranslate"><span class="pre">rasterio.open()</span></code>.</p>
</dd>
<dt>band_no: int</dt><dd><p>Raster band to be interpreted as the DEM.</p>
</dd>
<dt>method: str</dt><dd><p>Interpolation method used to extract elevation values from the
DEM.</p>
</dd>
<dt>autocenter: bool</dt><dd><p>Option to center the new elevations at <code class="docutils literal notranslate"><span class="pre">z=0</span></code>. True by default.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id86">
<h4>Returns:<a class="headerlink" href="#id86" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.save_Riser_instance_structure">
<span class="sig-name descname"><span class="pre">save_Riser_instance_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">savedir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.save_Riser_instance_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.save_Riser_instance_structure" title="Permalink to this definition"></a></dt>
<dd><p>Creates a .npy file containing all attributes of the Riser class
instance. This file can be used via
riserfit.load_Riser_instance_structure to re-load a Riser
class instance without re-running all analysis steps.
File name will always be
self.identifier+”Riser_instance_structure.npy”.</p>
<section id="id87">
<h4>Parameters:<a class="headerlink" href="#id87" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>savedir: str</dt><dd><p>Subdirectory to which the resulting file is saved.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id88">
<h4>Returns:<a class="headerlink" href="#id88" title="Permalink to this heading"></a></h4>
<blockquote>
<div><p>None</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.save_instance">
<span class="sig-name descname"><span class="pre">save_instance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">savedir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#Riser.save_instance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.Riser.save_instance" title="Permalink to this definition"></a></dt>
<dd><p>Save a Riser instance using Python’s pickle module.</p>
<section id="id89">
<h4>Parameters:<a class="headerlink" href="#id89" title="Permalink to this heading"></a></h4>
<blockquote>
<div><p>Path to subdirectory to which the file is saved.</p>
</div></blockquote>
</section>
<section id="id90">
<h4>Returns:<a class="headerlink" href="#id90" title="Permalink to this heading"></a></h4>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.symmetry_index">
<span class="sig-name descname"><span class="pre">symmetry_index</span></span><a class="headerlink" href="#riserfit.profiles.Riser.symmetry_index" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which compute_symmetry_index() stores results.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.terrace">
<span class="sig-name descname"><span class="pre">terrace</span></span><a class="headerlink" href="#riserfit.profiles.Riser.terrace" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which add_terrace_generation() stores the generation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.terrace_age">
<span class="sig-name descname"><span class="pre">terrace_age</span></span><a class="headerlink" href="#riserfit.profiles.Riser.terrace_age" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which add_cn_terrace_age() stores ages.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.terrace_age_sigma">
<span class="sig-name descname"><span class="pre">terrace_age_sigma</span></span><a class="headerlink" href="#riserfit.profiles.Riser.terrace_age_sigma" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which add_cn_terrace_age() stores uncertainty.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.upper_kt">
<span class="sig-name descname"><span class="pre">upper_kt</span></span><a class="headerlink" href="#riserfit.profiles.Riser.upper_kt" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which calculate_kt_uncertainty() stores an upper bound.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="riserfit.profiles.Riser.upstream_distance">
<span class="sig-name descname"><span class="pre">upstream_distance</span></span><a class="headerlink" href="#riserfit.profiles.Riser.upstream_distance" title="Permalink to this definition"></a></dt>
<dd><p>Attribute in which calculate_upstream_distance() stores upstream_distance.</p>
</dd></dl>

</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.profiles.center_elevation_profiles">
<span class="sig-prename descclassname"><span class="pre">riserfit.profiles.</span></span><span class="sig-name descname"><span class="pre">center_elevation_profiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">profiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'z'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#center_elevation_profiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.center_elevation_profiles" title="Permalink to this definition"></a></dt>
<dd><p>Automatically centers a profile close to the riser midpoint.
Uses the difference in maximum and minimum elevation to
find the midpoint height, and then shifts in d direction
such that this point is at d=0. Any additional calibration
of the profile should be done using
Riser.compute_best_linear_diffusion_fit() and
Riser.apply_d_z_offsets().</p>
<section id="id91">
<h3>Parameters:<a class="headerlink" href="#id91" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>profiles: list</dt><dd><p>List of pandas dfs with profile information.</p>
</dd>
<dt>df_z: str</dt><dd><p>Name of df column containing elevation information.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id92">
<h3>Returns:<a class="headerlink" href="#id92" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>out_profiles: list</dt><dd><p>Profile dfs with updated distances and elevations.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.profiles.initialize_riser_class">
<span class="sig-prename descclassname"><span class="pre">riserfit.profiles.</span></span><span class="sig-name descname"><span class="pre">initialize_riser_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">profiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'x_UTM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'y_UTM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'z'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Riser'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#riserfit.profiles.Riser" title="riserfit.profiles.Riser"><span class="pre">Riser</span></a></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#initialize_riser_class"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.initialize_riser_class" title="Permalink to this definition"></a></dt>
<dd><p>Function to construct the preprocessed profiles into
objects of the Riser class. Always returns one Riser class object that
stores all information in lists.</p>
<section id="id93">
<h3>Parameters:<a class="headerlink" href="#id93" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>profiles: list</dt><dd><p>Profiles to be initialized as Riser objects. Should be pandas
dataframes.</p>
</dd>
<dt>names: list</dt><dd><p>Names of profiles.</p>
</dd>
<dt>df_x: str</dt><dd><p>Name of column in .csv files where x coordinates of the profiles
are stored.</p>
</dd>
<dt>df_y: str</dt><dd><p>Name of column in .csv files where y coordinates of the profiles
are stored.</p>
</dd>
<dt>df_z: str</dt><dd><p>Name of column in .csv files where z coordinates of the profiles
are stored.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id94">
<h3>Returns:<a class="headerlink" href="#id94" title="Permalink to this heading"></a></h3>
<dl class="simple">
<dt>Riser:</dt><dd><p>Riser class object.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.profiles.load_Riser_instance_structure">
<span class="sig-prename descclassname"><span class="pre">riserfit.profiles.</span></span><span class="sig-name descname"><span class="pre">load_Riser_instance_structure</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#riserfit.profiles.Riser" title="riserfit.profiles.Riser"><span class="pre">Riser</span></a></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#load_Riser_instance_structure"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.load_Riser_instance_structure" title="Permalink to this definition"></a></dt>
<dd><p>This function loads a Riser instance from a <code class="docutils literal notranslate"><span class="pre">.npy</span></code> file.
The Riser attributes saved in the file should be in the form of a
dict. <code class="docutils literal notranslate"><span class="pre">riserfit.save_Riser_instance_structure()</span></code>
outputs a format that can be read by this function.</p>
<section id="id95">
<h3>Parameters:<a class="headerlink" href="#id95" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>filepath: str</dt><dd><p>Path to subdirectory and <code class="docutils literal notranslate"><span class="pre">.npy</span></code> file.</p>
</dd>
<dt>identifier: str</dt><dd><p>An optional Riser instance identifier,
set as the Riser.identifier. If “”, the identifier
of the created instance is chosen from
the <code class="docutils literal notranslate"><span class="pre">.npy</span></code> Riser instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id96">
<h3>Returns:<a class="headerlink" href="#id96" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>riser: class</dt><dd><p>Instance of the Riser class.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.profiles.load_instance">
<span class="sig-prename descclassname"><span class="pre">riserfit.profiles.</span></span><span class="sig-name descname"><span class="pre">load_instance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#riserfit.profiles.Riser" title="riserfit.profiles.Riser"><span class="pre">Riser</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#riserfit.statistics.RiserPlayground" title="riserfit.statistics.RiserPlayground"><span class="pre">RiserPlayground</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#riserfit.riser_maths.StatsMC" title="riserfit.riser_maths.StatsMC"><span class="pre">StatsMC</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#load_instance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.load_instance" title="Permalink to this definition"></a></dt>
<dd><p>Generic function to load a pickled class instance from a file. This
applies to saved <cite>Riser</cite>, <cite>RiserPlayground</cite>, and <cite>StatsMC</cite> instances.</p>
<section id="id97">
<h3>Parameters:<a class="headerlink" href="#id97" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>filename: str</dt><dd><p>The name of the file.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id98">
<h3>Returns:<a class="headerlink" href="#id98" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>instance: Riser | RiserPlayground | StatsMC</dt><dd><p>An instance of any of the three classes.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.profiles.read_profile_files">
<span class="sig-prename descclassname"><span class="pre">riserfit.profiles.</span></span><span class="sig-name descname"><span class="pre">read_profile_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">infiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profilenames</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'x_UTM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'y_UTM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pandas_csv_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#read_profile_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.read_profile_files" title="Permalink to this definition"></a></dt>
<dd><p>read_profile_files: Function to open and prepare data files for terrace
riser analysis. Files should be provided in .csv format and contain
x, y coordinates in meters (e.g. UTM), and elevation. Multiple riser
profiles may be stored in a single .csv file, as long as there is an
identifier column with unique names for each individual profile.
(E.g., all points are labelled as riser1-001,
riser1-002, …, riser2-001, … The identifiers should then be “riser1”,
“riser2”, etc.)</p>
<section id="id99">
<h3>Parameters:<a class="headerlink" href="#id99" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>filepath: str</dt><dd><p>Path to directory where data files with profile information are
stored.</p>
</dd>
<dt>infiles: list[str]</dt><dd><p>List of .csv files containing profiles to be loaded.</p>
</dd>
<dt>profilenames: list[str]</dt><dd><p>List of profile names to be searched for in the .csv files.
All rows that are assigned to a profile must contain the profile
name in the identifier column.</p>
</dd>
<dt>identifier: str</dt><dd><p>Name of the column that contains the name of a profile listed
in profilenames.</p>
</dd>
<dt>df_x: str</dt><dd><p>Name of column in .csv file where x coordinates of the profiles
are stored.</p>
</dd>
<dt>df_y: str</dt><dd><p>Name of column in .csv file where y coordinates of the profiles
are stored.</p>
</dd>
<dt>pandas_csv_dict: dir</dt><dd><p>Any arguments to be passed on to pandas.read_csv()</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id100">
<h3>Returns:<a class="headerlink" href="#id100" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>profiles: list</dt><dd><p>List of pandas dataframes containing separate profiles for which
data was found.</p>
</dd>
<dt>profilenames: list[str]</dt><dd><p>List containing all names of profiles for which data was found.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.profiles.reproject_profiles">
<span class="sig-prename descclassname"><span class="pre">riserfit.profiles.</span></span><span class="sig-name descname"><span class="pre">reproject_profiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">profiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'x_UTM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'y_UTM'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#reproject_profiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.reproject_profiles" title="Permalink to this definition"></a></dt>
<dd><p>For a list of pandas dfs containing gps profiles,
performs least square reprojection and re-calculates distances.
This function should only be used for profiles of individual
risers!</p>
<section id="id101">
<h3>Parameters:<a class="headerlink" href="#id101" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>profiles: list</dt><dd><p>List of pandas dfs containing riser profiles.</p>
</dd>
<dt>df_x: str</dt><dd><p>Name of the df x coordinate column.</p>
</dd>
<dt>df_y: str</dt><dd><p>Name of the df y coordinate column.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id102">
<h3>Returns:<a class="headerlink" href="#id102" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>df_out: list</dt><dd><p>Updated pandas dfs with reprojected profiles.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.profiles.split_elevation_profiles">
<span class="sig-prename descclassname"><span class="pre">riserfit.profiles.</span></span><span class="sig-name descname"><span class="pre">split_elevation_profiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">profiles</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">profilenames</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">savedirpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'x_UTM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'y_UTM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'z'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/riserfit/profiles.html#split_elevation_profiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.profiles.split_elevation_profiles" title="Permalink to this definition"></a></dt>
<dd><p>Split elevation profiles into individual riser profiles using
an interactive GUI. Process is saved along the way, even if the
script execution is interrupted at some point. User can decide
whether to split a profile via console inpute, and then select
the points between which a profile should be exctracted in a
plot window.</p>
<section id="id103">
<h3>Parameters:<a class="headerlink" href="#id103" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>profiles: list</dt><dd><p>List of input elevation profile dfs.</p>
</dd>
<dt>profilenames: list[str]</dt><dd><p>List of input elevation profile names.</p>
</dd>
<dt>savedirpath: str</dt><dd><p>Path to subdirectory where resulting .csv files
are to be saved.</p>
</dd>
<dt>df_x: str</dt><dd><p>Name of df column containing x coordinate values.</p>
</dd>
<dt>df_y: str</dt><dd><p>Name of df column containing y coordinate values</p>
</dd>
<dt>df_z: str</dt><dd><p>Name of df column containing elevation values</p>
</dd>
<dt>verbose: bool</dt><dd><p>Option to print some additional status updates
to console.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id104">
<h3>Returns:<a class="headerlink" href="#id104" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>output_df_collection: list</dt><dd><p>List of dfs for each individual riser profile.</p>
</dd>
<dt>output_name_collection: list</dt><dd><p>List of unique names for each riser profile.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

</section>
<section id="module-riserfit.riser_maths">
<span id="riserfit-riser-maths-module"></span><h2>riserfit.riser_maths module<a class="headerlink" href="#module-riserfit.riser_maths" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="riserfit.riser_maths.DistributionFromInterpolator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">DistributionFromInterpolator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pdf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/riserfit/riser_maths.html#DistributionFromInterpolator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.DistributionFromInterpolator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class that contains basic statistical tools for the use of probability
density functions.
This class is mainly for internal use. Some internal functionalities may not be
entirely correct in a strictly mathematical sense.</p>
<dl class="py method">
<dt class="sig sig-object py" id="riserfit.riser_maths.DistributionFromInterpolator.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#DistributionFromInterpolator.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.DistributionFromInterpolator.sample" title="Permalink to this definition"></a></dt>
<dd><p>Sample values from the PDF.</p>
<section id="id105">
<h3>Parameters:<a class="headerlink" href="#id105" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>resolution: float</dt><dd><p>The resolution in x. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, values are sampled from self.x.</p>
</dd>
<dt>n: float</dt><dd><p>Sample size.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id106">
<h3>Returns:<a class="headerlink" href="#id106" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>sample: np.ndarray</dt><dd><p>Sample from the PDF.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="riserfit.riser_maths.StatsMC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">StatsMC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lb_kt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ub_kt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'StatsMC'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/riserfit/riser_maths.html#StatsMC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.StatsMC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class provides tools for Monte Carlo simulations
to calibrate diffusivity and morphological age
based on a set of kt and an estimate of t.</p>
<dl class="py method">
<dt class="sig sig-object py" id="riserfit.riser_maths.StatsMC.construct_MC_k_kde">
<span class="sig-name descname"><span class="pre">construct_MC_k_kde</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.25</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#StatsMC.construct_MC_k_kde"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.StatsMC.construct_MC_k_kde" title="Permalink to this definition"></a></dt>
<dd><p>Estimate a PDF of k by sampling self.kt_kde and self.t_kde.
t is treated as a Gaussian variable and the resulting KDE kernel is
a reciprocal inverse Gaussian. The resulting KDE is available in
StatsMC.k_kde and is an instance of riserfit.DistributionFromInterpolator.</p>
<section id="id107">
<h3>Parameters:<a class="headerlink" href="#id107" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>n: int</dt><dd><p>Number of random draws from self.kt_kde</p>
</dd>
<dt>min_val: float</dt><dd><p>Minimum value for the k PDF.</p>
</dd>
<dt>max_val: float</dt><dd><p>Maximum value for the k PDF.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id108">
<h3>Returns:<a class="headerlink" href="#id108" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>A PDF instance of the
riserfit.DistributionFromInterpolator class.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.riser_maths.StatsMC.construct_MC_t_kde">
<span class="sig-name descname"><span class="pre">construct_MC_t_kde</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#StatsMC.construct_MC_t_kde"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.StatsMC.construct_MC_t_kde" title="Permalink to this definition"></a></dt>
<dd><p>Generate a set of morphological ages (with unit time) from
self.k_kde and self.kt_kde. This is independent of self.t_kde!
The resulting KDE is available in StatsMC.MC_t_kde and is an
instance of riserfit.DistributionFromInterpolator.</p>
<section id="id109">
<h3>Parameters:<a class="headerlink" href="#id109" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>min_val: float</dt><dd><p>Lower bound of the KDE.</p>
</dd>
<dt>max_val: float</dt><dd><p>Upper bound of the KDE.</p>
</dd>
<dt>n: int</dt><dd><p>Number of draws.</p>
</dd>
<dt>t_resolution: float</dt><dd><p>Resolution of t values.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id110">
<h3>Returns:<a class="headerlink" href="#id110" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The StatsMC instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.riser_maths.StatsMC.construct_initial_t_kde">
<span class="sig-name descname"><span class="pre">construct_initial_t_kde</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kde:</span> <span class="pre">callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">kde_gaussian&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_resolution:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#StatsMC.construct_initial_t_kde"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.StatsMC.construct_initial_t_kde" title="Permalink to this definition"></a></dt>
<dd><p>Construct a KDE from independent age constraints. This function
sets the StatsMC.initial_t_kde attribute, which is an instance
of riserfit.DistributionFromInterpolator.</p>
<section id="id111">
<h3>Parameters:<a class="headerlink" href="#id111" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>kde: callable</dt><dd><p>The type of KDE to be output. Must be a function.
Default is riserfit.kde_gaussian.</p>
</dd>
<dt>t_resolution: float</dt><dd><p>The resolution at which t values are calculated.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id112">
<h3>Returns:<a class="headerlink" href="#id112" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The StatsMC instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.riser_maths.StatsMC.construct_kt_kde">
<span class="sig-name descname"><span class="pre">construct_kt_kde</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kde:</span> <span class="pre">callable</span> <span class="pre">=</span> <span class="pre">&lt;function</span> <span class="pre">triang_kde&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_val:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_val:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">10000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kt_resolution:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#StatsMC.construct_kt_kde"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.StatsMC.construct_kt_kde" title="Permalink to this definition"></a></dt>
<dd><p>Constructs a KDE of kt from which to sample. This self.kt_kde inherits
its methods from scipy.stats.rv_continuous</p>
<section id="id113">
<h3>Parameters:<a class="headerlink" href="#id113" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>kde: callable</dt><dd><p>A function that takes on values specified by kde_dict.
Must take arguments in the form kde(x, lb, mid, ub).</p>
</dd>
<dt>min_val: float</dt><dd><p>Lower bound of the KDE, if not defined within the kde callable.</p>
</dd>
<dt>max_val: float</dt><dd><p>Upper bound of the KDE, if not defined within the kde callable.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id114">
<h3>Returns:<a class="headerlink" href="#id114" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>A PDF instance of the riserfit.CustomDistribution class.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.riser_maths.StatsMC.construct_paired_t_kde">
<span class="sig-name descname"><span class="pre">construct_paired_t_kde</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">min_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_vals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_resolution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/riserfit/riser_maths.html#StatsMC.construct_paired_t_kde"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.StatsMC.construct_paired_t_kde" title="Permalink to this definition"></a></dt>
<dd><p>EXPERIMENTAL; DO NOT USE</p>
<section id="id115">
<h3>Parameters:<a class="headerlink" href="#id115" title="Permalink to this heading"></a></h3>
<blockquote>
<div><p>None</p>
</div></blockquote>
</section>
<section id="id116">
<h3>Returns:<a class="headerlink" href="#id116" title="Permalink to this heading"></a></h3>
<blockquote>
<div><p>None</p>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.riser_maths.StatsMC.save_instance">
<span class="sig-name descname"><span class="pre">save_instance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">savedir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#StatsMC.save_instance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.StatsMC.save_instance" title="Permalink to this definition"></a></dt>
<dd><p>Save a StatsMC instance to a .pickle file. Instance can be re-loaded
using load_StatsMC_instance().</p>
<section id="id117">
<h3>Parameters:<a class="headerlink" href="#id117" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>savedir: str</dt><dd><p>Path to the sub directory.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id118">
<h3>Returns:<a class="headerlink" href="#id118" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The StatsMC instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.riser_maths.StatsMC.set_k_kde">
<span class="sig-name descname"><span class="pre">set_k_kde</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">k_kde</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">callable</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#StatsMC.set_k_kde"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.StatsMC.set_k_kde" title="Permalink to this definition"></a></dt>
<dd><p>Use a k_kde from some external source to set StatsMC.k_kde.
Should behave similar to
a riserfit.DistributionFromInterpolator instance.</p>
<section id="id119">
<h3>Parameters:<a class="headerlink" href="#id119" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>k_kde: callable</dt><dd><p>KDE to be used for drawing random samples from.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id120">
<h3>Returns:<a class="headerlink" href="#id120" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The StatsMC instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.riser_maths.analytical_derivative">
<span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">analytical_derivative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#analytical_derivative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.analytical_derivative" title="Permalink to this definition"></a></dt>
<dd><p>analytival_derivative: Function to compute the first derivative in space of
the riser scarp equation (analytical_profile()).
Taken from Pelletier et al. (2006).</p>
<section id="id121">
<h3>Parameters:<a class="headerlink" href="#id121" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>d: np.ndarray</dt><dd><p>Along-profile distances.</p>
</dd>
<dt>kt: float</dt><dd><p>Diffusion age.</p>
</dd>
<dt>a: float</dt><dd><p>Initial half riser height.</p>
</dd>
<dt>b: float</dt><dd><p>Far field gradient.</p>
</dd>
<dt>theta: float</dt><dd><p>Initial gradient at midpoint and age zero.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id122">
<h3>Returns:<a class="headerlink" href="#id122" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>dhdx: np.ndarray</dt><dd><p>Derivative in space for each point.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.riser_maths.analytical_profile">
<span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">analytical_profile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warning_eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1e-10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#analytical_profile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.analytical_profile" title="Permalink to this definition"></a></dt>
<dd><p>Function to compute elevation of a riser profile
defined by kt, a, b and theta along points x. Uses the equation proposed by
Hanks and Andrews (1989), based on linear diffusion assumptions.</p>
<section id="id123">
<h3>Parameters:<a class="headerlink" href="#id123" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>d: np.ndarray</dt><dd><p>Points where the elevations of the scarp are to be calculated</p>
</dd>
<dt>kt: float</dt><dd><p>Diffusion age of the scarp.</p>
</dd>
<dt>a: float</dt><dd><p>Half the initial riser height (at kt=0).</p>
</dd>
<dt>b: float</dt><dd><p>Far field slope of the scarp.</p>
</dd>
<dt>theta: float</dt><dd><p>Initial riser gradient (at kt=0).</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id124">
<h3>Returns:<a class="headerlink" href="#id124" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>h: np.ndarray</dt><dd><p>Array of elevations for the riser profile.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.riser_maths.calculate_function_jacobian">
<span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">calculate_function_jacobian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameter_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.4901161193847656e-08</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#calculate_function_jacobian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.calculate_function_jacobian" title="Permalink to this definition"></a></dt>
<dd><p>Calculates a finite difference approximation of the Jacobian.
If func takes p+1 parameters, the Jacobian will have p columns.
The first function argument must always be a vector of x values.
For n x_values, the Jacobian will have n rows.</p>
<section id="id125">
<h3>Parameters:<a class="headerlink" href="#id125" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>func: Callable</dt><dd><p>Function of the form func(x_values, …).</p>
</dd>
<dt>x_values: ArrayLike</dt><dd><p>x values at which the partial derivatives are
evaluated.</p>
</dd>
<dt>parameter_values: dict</dt><dd><p>Dictionary of the form {key: value, …} for all
parameters to be passed on to func(), except
x_values. The partial derivatives are calculated,
in the same order, for each key in the dict.</p>
</dd>
<dt>epsilon: ArrayLike | float</dt><dd><p>Epsilon used for finite difference derivative
calculation. May be an array of length
len(parameter_values.keys()) or a single float.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id126">
<h3>Returns:<a class="headerlink" href="#id126" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>jacobian: np.ndarray</dt><dd><p>The Jacobian matrix of func().</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.riser_maths.calculate_wei_2015_sigma">
<span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">calculate_wei_2015_sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">residuals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#calculate_wei_2015_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.calculate_wei_2015_sigma" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the sigma used for uncertainty interval calculation
in Wei et al. 2015.</p>
<section id="id127">
<h3>Parameters:<a class="headerlink" href="#id127" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>residuals: np.ndarray</dt><dd><p>The residuals between data and model.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id128">
<h3>Returns:<a class="headerlink" href="#id128" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>sigma: float</dt><dd><p>The sigma as in Wei et al. 2015.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.riser_maths.compute_misfit">
<span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">compute_misfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_emp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_emp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_off</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_off</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warning_eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1e-10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#compute_misfit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.compute_misfit" title="Permalink to this definition"></a></dt>
<dd><p>compute_misfit: Function to compute the misfit between a profile defined
by d_emp and z_emp and an analytical curve defined by kt, a, b, theta at
points d_emp. The function uses the weighted misfit formula
of Avouac (1993). d_off and z_off are set to zero by default, but should
be varied during curve fitting.</p>
<section id="id129">
<h3>Parameters:<a class="headerlink" href="#id129" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>kt: float</dt><dd><p>Diffusion age of the analytical profile.</p>
</dd>
<dt>d_emp: np.array</dt><dd><p>Along profile distances for a profile.</p>
</dd>
<dt>z_emp: np.array</dt><dd><p>Elevations along the profile.</p>
</dd>
<dt>a: float</dt><dd><p>Half of the initial scarp height of the analytical profile.</p>
</dd>
<dt>b: float</dt><dd><p>Far field gradient of the analytical profile.</p>
</dd>
<dt>theta: float</dt><dd><p>Initial gradient of the analytical profile.</p>
</dd>
<dt>d_off: float</dt><dd><p>Offset in along-profile distance, used to adjust riser profile in
horizontal direction.</p>
</dd>
<dt>z_off: float</dt><dd><p>Offset in elevation, used to adjust riser profile in vertical
direction.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id130">
<h3>Returns:<a class="headerlink" href="#id130" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>misfit: float</dt><dd><p>Misfit value indicating the quality of fit between the real and
analytical profile</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.riser_maths.construct_averaged_kde">
<span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">construct_averaged_kde</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">list_of_StatsMC</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'k_kde'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#riserfit.riser_maths.DistributionFromInterpolator" title="riserfit.riser_maths.DistributionFromInterpolator"><span class="pre">DistributionFromInterpolator</span></a></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#construct_averaged_kde"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.construct_averaged_kde" title="Permalink to this definition"></a></dt>
<dd><p>Computes an averaged PDF based on a number of input PDFs. This function
is explicitly for use on multiple StatsMC instances.</p>
<section id="id131">
<h3>Parameters:<a class="headerlink" href="#id131" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>list_of_StatsMC: list</dt><dd><p>List containing StatsMC instances. Each instance must posses
the PDF or KDE to be sampled.</p>
</dd>
<dt>min_val: float</dt><dd><p>Minimum value of the averaged PDF.</p>
</dd>
<dt>max_val: float</dt><dd><p>Maximum value of the averaged PDF.</p>
</dd>
<dt>resolution: float</dt><dd><p>Step size of the averaged PDF.</p>
</dd>
<dt>attr: str</dt><dd><p>The KDE or PDF to be averaged for each StatsMC. Default is
<code class="docutils literal notranslate"><span class="pre">k_kde</span></code>. Must match an existing instance attribute.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id132">
<h3>Returns:<a class="headerlink" href="#id132" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>pdf: DistributionFromInterpolater</dt><dd><p>Distribution instance containing the averaged PDF.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.riser_maths.distance_along_line">
<span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">distance_along_line</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">point_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#distance_along_line"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.distance_along_line" title="Permalink to this definition"></a></dt>
<dd><p>Caluclates the minimum distance between the provided point (x, y), and
a list of point tuples (xx, yy), and returns the the id of the closest tuple.</p>
<section id="id133">
<h3>Parameters:<a class="headerlink" href="#id133" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>x: float</dt><dd><p>X coordinate.</p>
</dd>
<dt>y: float</dt><dd><p>Y coordinate.</p>
</dd>
<dt>point_list: list</dt><dd><p>List of points in (x, y) format.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id134">
<h3>Returns:<a class="headerlink" href="#id134" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>id_min: int</dt><dd><p>Index of closest tuple in point_list.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.riser_maths.distribution_from_sample">
<span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">distribution_from_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0,</span> <span class="pre">0)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#riserfit.riser_maths.DistributionFromInterpolator" title="riserfit.riser_maths.DistributionFromInterpolator"><span class="pre">DistributionFromInterpolator</span></a></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#distribution_from_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.distribution_from_sample" title="Permalink to this definition"></a></dt>
<dd><p>Create a riserfit.DistributionFromInterpolator instance from
a sample of size n. A PDF is generated by calculating a CDF,
interpolating it to even spacing determined by <cite>resolution</cite>
and calculating its derivative, the PDF.</p>
<section id="id135">
<h3>Parameters:<a class="headerlink" href="#id135" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>sample: np.ndarray</dt><dd><p>The sample array.</p>
</dd>
<dt>resolution: float</dt><dd><p>The resolution at which the CDF is interpolated.
Smaller values can give more accurate results, but also
increase the noise that is present.</p>
</dd>
<dt>bounds: tuple</dt><dd><p>Optional bounds within which the PDF has values larger than 0.
If <cite>(0, 0)</cite>, the minimum and maximum sample values are used as bounds.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id136">
<h3>Returns:<a class="headerlink" href="#id136" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>distribution: DistributionFromInterpolator</dt><dd><p>A <cite>DistributionFromInterpolator</cite> instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.riser_maths.gaussian">
<span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.gaussian" title="Permalink to this definition"></a></dt>
<dd><p>Gaussian/Normal distribution.</p>
<section id="id137">
<h3>Parameters:<a class="headerlink" href="#id137" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>x: np.ndarray</dt><dd><p>Values at which to return PDF values.</p>
</dd>
<dt>mu: float</dt><dd><p>The mean of the Gaussian.</p>
</dd>
<dt>sigma: float</dt><dd><p>The standard deviation of the Gaussian.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id138">
<h3>Returns:<a class="headerlink" href="#id138" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>pdf: np.ndarray</dt><dd><p>The Gaussian PDF values.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.riser_maths.gaussian_kernel">
<span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">gaussian_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#gaussian_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.gaussian_kernel" title="Permalink to this definition"></a></dt>
<dd><p>Returns the PDF of a Gaussian distribution
for an input array x.</p>
<section id="id139">
<h3>Parameters:<a class="headerlink" href="#id139" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>x: np.ndarray</dt><dd><p>Values along the x axis.</p>
</dd>
<dt>mu: float</dt><dd><p>Mean of the Gaussian distribution.</p>
</dd>
<dt>sigma: float</dt><dd><p>Standard deviation of the
Gaussian distribution.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id140">
<h3>Returns:<a class="headerlink" href="#id140" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>pdf: np.ndarray</dt><dd><p>PDF values of the Gaussian at positions
specified by x.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.riser_maths.kde_gaussian">
<span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">kde_gaussian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">si</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/riserfit/riser_maths.html#kde_gaussian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.kde_gaussian" title="Permalink to this definition"></a></dt>
<dd><p>Creates a KDE (or composite PDF) out of multiple
Gaussian distributions.</p>
<section id="id141">
<h3>Parameters:<a class="headerlink" href="#id141" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>x: np.ndarray</dt><dd><p>The values along the x axis where KDE
values are output.</p>
</dd>
<dt>xi: np.ndarray</dt><dd><p>An array of Gaussian mean values (mu)
for each Gaussian distribution.</p>
</dd>
<dt>si: np.ndarray</dt><dd><p>An array of standard deviations (sigma)
for each Gaussian distribution.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id142">
<h3>Returns:<a class="headerlink" href="#id142" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>kde: np.ndarray</dt><dd><p>Array of length len(x) containing KDE
values along the x axis.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.riser_maths.least_square_reproject">
<span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">least_square_reproject</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#least_square_reproject"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.least_square_reproject" title="Permalink to this definition"></a></dt>
<dd><p>Computes best fit line and reprojects all points onto that
line.</p>
<section id="id143">
<h3>Parameters:<a class="headerlink" href="#id143" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>x: ArrayLike</dt><dd><p>Coordinates in x direction.</p>
</dd>
<dt>y: ArrayLike</dt><dd><p>Coordinates in y dirextion.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id144">
<h3>Returns:<a class="headerlink" href="#id144" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>x_out: np.ndarray</dt><dd><p>Reprojected coordinates in x direction.</p>
</dd>
<dt>y_out: np.ndarray</dt><dd><p>Reprojected coordinates in y direction.</p>
</dd>
<dt>d_out: np.ndarray</dt><dd><p>Re-calculated distances for the new coordinates.</p>
</dd>
<dt>dd_out: np.ndarray</dt><dd><p>Re-calculated diff. distances for the new
coordinates.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.riser_maths.load_StatsMC_instance">
<span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">load_StatsMC_instance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#riserfit.riser_maths.StatsMC" title="riserfit.riser_maths.StatsMC"><span class="pre">StatsMC</span></a></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#load_StatsMC_instance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.load_StatsMC_instance" title="Permalink to this definition"></a></dt>
<dd><p>Load a StatsMC instance from a pickled file.</p>
<section id="id145">
<h3>Parameters:<a class="headerlink" href="#id145" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>filename: str</dt><dd><p>Name of the file in the current working directory.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id146">
<h3>Returns:<a class="headerlink" href="#id146" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>smc: StatsMC</dt><dd><p>StatsMC instance loaded from the file.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.riser_maths.maximum_combined_kde">
<span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">maximum_combined_kde</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_vals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kdes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bounds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(None,</span> <span class="pre">None)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#maximum_combined_kde"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.maximum_combined_kde" title="Permalink to this definition"></a></dt>
<dd><p>Expects a list of arrays, each of len(x_vals). Will combine the KDEs and
compute the maximum-likelihood of all KDEs. Returns the x value and id.</p>
<section id="id147">
<h3>Parameters:<a class="headerlink" href="#id147" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>x_vals: np.ndarray</dt><dd><p>X values at which the KDEs are defined.</p>
</dd>
<dt>kdes: list</dt><dd><p>List of np.ndarrays containing the KDE values.</p>
</dd>
<dt>bounds: Tuple[float, float]</dt><dd><p>Bounds applied to x_vals within which a maximum value is
calculated. Should be (lower_bound, upper_bound).</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id148">
<h3>Returns:<a class="headerlink" href="#id148" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>x_max: float</dt><dd><p>Position of the maximum KDE value.</p>
</dd>
<dt>id_max: int</dt><dd><p>ID of the maximum value.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.riser_maths.propagate_division_error">
<span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">propagate_division_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">denom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">denom_error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#propagate_division_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.propagate_division_error" title="Permalink to this definition"></a></dt>
<dd><p>Approximates the error for a fraction num / denom where both
the numerator and the denominator have an associated error.</p>
<section id="id149">
<h3>Parameters:<a class="headerlink" href="#id149" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>num: float</dt><dd><p>Numerator.</p>
</dd>
<dt>denum: float</dt><dd><p>Denominator.</p>
</dd>
<dt>num_error: float</dt><dd><p>Error or uncertainty associated with the numerator.</p>
</dd>
<dt>denom_error: float</dt><dd><p>Error or uncertainty associated with the denominator.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id150">
<h3>Returns:<a class="headerlink" href="#id150" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>error: float</dt><dd><p>The propagated error.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.riser_maths.riser_covariance_matrix">
<span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">riser_covariance_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jacobian</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sum_of_squares</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#riser_covariance_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.riser_covariance_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Converts a jacobian to a covariance matrix based on
<span class="math notranslate nohighlight">\(Cov = sos\cdot(J^t \cdot J)^(-1)\)</span></p>
<section id="id151">
<h3>Parameters:<a class="headerlink" href="#id151" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>jacobian: np.ndarray</dt><dd><p>The Jacobian.</p>
</dd>
<dt>sum_of_squares: float</dt><dd><p>Sum of squares error.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id152">
<h3>Returns:<a class="headerlink" href="#id152" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>cov_mat: np.ndarray</dt><dd><p>The covariance matrix.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.riser_maths.triang_kde">
<span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">triang_kde</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ub</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#triang_kde"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.triang_kde" title="Permalink to this definition"></a></dt>
<dd><p>A KDE composed of multiple triangular PDFs.</p>
<section id="id153">
<h3>Parameters:<a class="headerlink" href="#id153" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>x: np.ndarray</dt><dd><p>Values along the x axis.</p>
</dd>
<dt>lb: np.ndarray</dt><dd><p>Lower bounds of the triangular PDFs.</p>
</dd>
<dt>mid: np.ndarray</dt><dd><p>Maximum values of the triangular PDFs.</p>
</dd>
<dt>ub: np.ndarray</dt><dd><p>Upper bounds of the triangular PDFs.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id154">
<h3>Returns:<a class="headerlink" href="#id154" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>pdf: np.ndarray</dt><dd><p>The KDE values.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.riser_maths.triang_kernel">
<span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">triang_kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ub</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#triang_kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.triang_kernel" title="Permalink to this definition"></a></dt>
<dd><p>A triangular PDF.</p>
<section id="id155">
<h3>Parameters:<a class="headerlink" href="#id155" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>x: np.ndarray</dt><dd><p>Values along the x axis.</p>
</dd>
<dt>lb: float</dt><dd><p>Lower bound of the PDF.</p>
</dd>
<dt>mid: float</dt><dd><p>Maximum value of the PDF.</p>
</dd>
<dt>ub: float</dt><dd><p>Upper bound of the PDF.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id156">
<h3>Returns:<a class="headerlink" href="#id156" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>pdf: np.ndarray</dt><dd><p>The triangular PDF values.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.riser_maths.xy_distances">
<span class="sig-prename descclassname"><span class="pre">riserfit.riser_maths.</span></span><span class="sig-name descname"><span class="pre">xy_distances</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/riserfit/riser_maths.html#xy_distances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.riser_maths.xy_distances" title="Permalink to this definition"></a></dt>
<dd><p>Small function to compute the euclidian distance between equal
length arrays of x and y coordinates.</p>
<section id="id157">
<h3>Parameters:<a class="headerlink" href="#id157" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>x: ArrayLike</dt><dd><p>Coordinates in x direction.</p>
</dd>
<dt>y: ArrayLike</dt><dd><p>Coordinates in y direction.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id158">
<h3>Returns:<a class="headerlink" href="#id158" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>d: np.ndarray</dt><dd><p>Cumulative distances starting at 0.</p>
</dd>
<dt>dd: np.ndarray</dt><dd><p>Differential distances.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

</section>
<section id="module-riserfit.statistics">
<span id="riserfit-statistics-module"></span><h2>riserfit.statistics module<a class="headerlink" href="#module-riserfit.statistics" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="riserfit.statistics.RiserPlayground">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">riserfit.statistics.</span></span><span class="sig-name descname"><span class="pre">RiserPlayground</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">identifier</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/riserfit/statistics.html#RiserPlayground"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.statistics.RiserPlayground" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#riserfit.profiles.Riser" title="riserfit.profiles.Riser"><code class="xref py py-class docutils literal notranslate"><span class="pre">Riser</span></code></a></p>
<p>This class inherits methods from riserfit.Riser class.
It contains additional methods to perfom various Monte Carlo-style
analyses of noise and other uncertainties.
It can copy the data available in a Riser instance,
or generate synthetic profiles.</p>
<dl class="py method">
<dt class="sig sig-object py" id="riserfit.statistics.RiserPlayground.add_gaussian_z_noise">
<span class="sig-name descname"><span class="pre">add_gaussian_z_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">12.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/statistics.html#RiserPlayground.add_gaussian_z_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.statistics.RiserPlayground.add_gaussian_z_noise" title="Permalink to this definition"></a></dt>
<dd><p>Add noise specified by a gaussian distribution N(mean_z, std_z)
to each profile’s elevation. If this function is called multiple
times for the same riserfit.RiserPlayground() instance, noise
will be cummulative.</p>
<section id="id159">
<h3>Parameters:<a class="headerlink" href="#id159" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>dx: float</dt><dd><p>Spatial resolution of the gaussian noise. If None,
a noise value is calculated for each point of data.
Otherwise, it is calculated at
np.arange(self.d[i].min()+cell_shift, self.d[i].max(),dx)
and interpolated to match self.d[i].</p>
</dd>
<dt>mean_z: float</dt><dd><p>The mean of the gaussian distribution.</p>
</dd>
<dt>std_z: float</dt><dd><p>The standard deviation of the gaussian distribution.</p>
</dd>
<dt>method: str</dt><dd><p>The interpolation method used if dx != None.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id160">
<h3>Returns:<a class="headerlink" href="#id160" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The RiserPlayground instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.statistics.RiserPlayground.best_fit_gaussian_z_noise">
<span class="sig-name descname"><span class="pre">best_fit_gaussian_z_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.17</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.28</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_linear_fit_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_uncert</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kt_uncert_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{'verbose':</span> <span class="pre">False}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/statistics.html#RiserPlayground.best_fit_gaussian_z_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.statistics.RiserPlayground.best_fit_gaussian_z_noise" title="Permalink to this definition"></a></dt>
<dd><p>Add noise specified by a gaussian distribution N(mean_z, std_z)
to each profile. If mean_z, std_z may be provided as iterables with
one entry for each profile. This function can be called multiple
times in a row and will add noise each time to the original profile
elevation values.</p>
<section id="id161">
<h3>Parameters:<a class="headerlink" href="#id161" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>dx: float</dt><dd><p>Spatial resolution of the gaussian noise. If None,
noise is calculated for each data point. If float,
noise is calculated along a regular grid and
interpolated to the data points.</p>
</dd>
<dt>mean_z: float | list</dt><dd><p>Mean(s) of the gaussian distribution(s) describing the
level of gaussian noise added to each sample.</p>
</dd>
<dt>std_z: float | list</dt><dd><p>Standard deviation(s) of the gaussian distribution(s)
describing the noise added to each sample.</p>
</dd>
<dt>method: str</dt><dd><p>Interpolation method used if dx != None.</p>
</dd>
<dt>best_linear_fit_dict: dict</dt><dd><p>Keyword dictionary passed to
riserfit.Riser.compute_best_linear_diffusion_fit().</p>
</dd>
<dt>calc_uncert: bool</dt><dd><p>Calculate the kt uncertainties each iteration.</p>
</dd>
<dt>kt_uncert_dict: dict</dt><dd><p>Keywords to pass to calculate_kt_uncertainty().</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id162">
<h3>Returns:<a class="headerlink" href="#id162" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The RiserPlayground instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.statistics.RiserPlayground.best_nonlin_fit_gaussian_z_noise">
<span class="sig-name descname"><span class="pre">best_nonlin_fit_gaussian_z_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.17</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.28</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_linear_fit_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_nonlin_fit_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">calc_uncert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/statistics.html#RiserPlayground.best_nonlin_fit_gaussian_z_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.statistics.RiserPlayground.best_nonlin_fit_gaussian_z_noise" title="Permalink to this definition"></a></dt>
<dd><p>Add noise specified by a gaussian distribution N(mean_z, std_z)
to each profile. If mean_z, std_z may be provided as iterables with
one entry for each profile. If this function is called multiple times
in sequence, it will add the noise to the original elevations.</p>
<section id="id163">
<h3>Parameters:<a class="headerlink" href="#id163" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>dx: float</dt><dd><p>Spatial resolution of the gaussian noise. If None,
noise is calculated for each data point. If float,
noise is calculated along a regular grid and
interpolated to the data points.</p>
</dd>
<dt>mean_z: float | list</dt><dd><p>Mean(s) of the gaussian distribution(s) describing the
level of gaussian noise added to each sample.</p>
</dd>
<dt>std_z: float | list</dt><dd><p>Standard deviation(s) of the gaussian distribution(s)
describing the noise added to each sample.</p>
</dd>
<dt>method: str</dt><dd><p>Interpolation method used if dx != None.</p>
</dd>
<dt>best_linear_fit_dict: dict</dt><dd><p>Keyword dictionary passed to
riserfit.Riser.compute_best_linear_diffusion_fit()</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id164">
<h3>Returns:<a class="headerlink" href="#id164" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The RiserPlayground instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.statistics.RiserPlayground.create_profiles_from_parameters">
<span class="sig-name descname"><span class="pre">create_profiles_from_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d_off</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z_off</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uniform_d</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_linear</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nonlin_S_c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/statistics.html#RiserPlayground.create_profiles_from_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.statistics.RiserPlayground.create_profiles_from_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Create riser profiles based on user-defined parameters.
These can be supplied either as single numbers or lists.</p>
<section id="id165">
<h3>Parameters:<a class="headerlink" href="#id165" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>d: list</dt><dd><p>Distance values at which z are to be calculated.
If uniform_d is False, interpreted as a nested list.</p>
</dd>
<dt>kt: float | list</dt><dd><p>Diffusion age(s) for each profile.</p>
</dd>
<dt>a: float | list</dt><dd><p>Riser height(s) for each profile.</p>
</dd>
<dt>b: float | list</dt><dd><p>Riser far field slope(s) for each profile.</p>
</dd>
<dt>theta: float | list</dt><dd><p>Initial riser slope(s) for each profile.</p>
</dd>
<dt>d_off: float | list</dt><dd><p>Shift(s) applied to d after elevations are calculated.</p>
</dd>
<dt>z_off: float | list</dt><dd><p>Shift(s) applied to z after elevations are calculated.</p>
</dd>
<dt>name: str | list</dt><dd><p>Name(s) for each riser.</p>
</dd>
<dt>uniform_d: bool</dt><dd><p>Defines the role of d: If True, d is interpreted as a
single non-nested list or array used as distance values.
If False, interpreted as a nested list wherein each
element defines a unique distance array used for creating
riser profiles.</p>
</dd>
<dt>use_linear: bool</dt><dd><p>If <cite>True</cite>, interpret kt as linear diffusion age. If <cite>False</cite>,
assume nonlinear diffusion age. Computing nonlinear profiles
may take a significant amount of time.</p>
</dd>
<dt>max_dt: float</dt><dd><p>Maximum time step size allowed when building nonlinear profiles.</p>
</dd>
<dt>nonlin_S_c: float</dt><dd><p>Critical slope used for nonlinear riser profiles.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id166">
<h3>Returns:<a class="headerlink" href="#id166" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The RiserPlayground instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.statistics.RiserPlayground.downsample_upsample_profiles">
<span class="sig-name descname"><span class="pre">downsample_upsample_profiles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resample_dx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">12.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cubic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_noise</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_z</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.75</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/statistics.html#RiserPlayground.downsample_upsample_profiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.statistics.RiserPlayground.downsample_upsample_profiles" title="Permalink to this definition"></a></dt>
<dd><p>Basic simulation of constructing a DEM from averaged binned
elevations, and then resampling these binned values back
to the original resolution.
Noise can be added onto the down-sampled DEM resolution cells.</p>
<section id="id167">
<h3>Parameters:<a class="headerlink" href="#id167" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>resample_dx: float</dt><dd><p>Grid size of the simulated DEM, in meters.</p>
</dd>
<dt>cell_shift: float</dt><dd><p>Offset at beginning of profile. Prevents
smaller bins at the beginning and may
introduce asymmetry in the resampled profile.
Value should be &gt;= 0, or unaccounted
boundary effects may occur.</p>
</dd>
<dt>method: str</dt><dd><p>Interpolation method for resampling. Must be
accepted by scipy.interpolate.interp1d().</p>
</dd>
<dt>add_noise: bool</dt><dd><p>Option to add noise to the downsampled profile.</p>
</dd>
<dt>mean_z: float</dt><dd><p>Mean value of the vertical noise.</p>
</dd>
<dt>std_z: float</dt><dd><p>Standard deviation of the vertical noise.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id168">
<h3>Returns:<a class="headerlink" href="#id168" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The RiserPlayground instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="riserfit.statistics.RiserPlayground.load_profiles_from_Riser">
<span class="sig-name descname"><span class="pre">load_profiles_from_Riser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Riser_instance</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Self</span></span></span><a class="reference internal" href="_modules/riserfit/statistics.html#RiserPlayground.load_profiles_from_Riser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.statistics.RiserPlayground.load_profiles_from_Riser" title="Permalink to this definition"></a></dt>
<dd><p>Load d, z values from a Riser class instance.</p>
<section id="id169">
<h3>Parameters:<a class="headerlink" href="#id169" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>Riser_instance: class</dt><dd><p>An instance of the riserfit.Riser class.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id170">
<h3>Returns:<a class="headerlink" href="#id170" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>self: Self</dt><dd><p>The RiserPlayground instance.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.statistics.calculate_confidence_interval">
<span class="sig-prename descclassname"><span class="pre">riserfit.statistics.</span></span><span class="sig-name descname"><span class="pre">calculate_confidence_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.158</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ub</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.84</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode_center</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/riserfit/statistics.html#calculate_confidence_interval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.statistics.calculate_confidence_interval" title="Permalink to this definition"></a></dt>
<dd><p>Calculates a confidence interval based on a non-parametric KDE.
If mode_center == False, lb is interpreted as
integral_{-infty}^lb_x KDE = lb, and ub as
integral_{-infty}^ub_x KDE = ub.
If mode_center == True, lb defines the area under the KDE between
lb_x and the mode. ub defines the area between the mode and ub_x.</p>
<section id="id171">
<h3>Parameters:<a class="headerlink" href="#id171" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>x: np.array</dt><dd><p>x values corresponding to known KDE values.</p>
</dd>
<dt>p: np.array</dt><dd><p>KDE values.</p>
</dd>
<dt>lb: float</dt><dd><p>Either lower bound of the cumulative KDE, or the area between
lb_x and mode.</p>
</dd>
<dt>ub: float</dt><dd><p>Either upper bound of the cumultive KDE, or the area between
mode and ub_x.</p>
</dd>
<dt>mode_center: bool</dt><dd><p>If mode_center == False, lb is interpreted as
integral_{-infty}^lb_x KDE = lb, and ub as
integral_{-infty}^ub_x KDE = ub.
If mode_center == True, lb defines the area under the KDE
between lb_x and the mode. ub defines the area between
the mode and ub_x.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id172">
<h3>Returns:<a class="headerlink" href="#id172" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>lb_x: float</dt><dd><p>The lower bound.</p>
</dd>
<dt>ub_x: float</dt><dd><p>The upper bound.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.statistics.calculate_lin_reg_confidence_interval">
<span class="sig-prename descclassname"><span class="pre">riserfit.statistics.</span></span><span class="sig-name descname"><span class="pre">calculate_lin_reg_confidence_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slope</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intercept</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/riserfit/statistics.html#calculate_lin_reg_confidence_interval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.statistics.calculate_lin_reg_confidence_interval" title="Permalink to this definition"></a></dt>
<dd><p>Confidence interval around linear regression. For a detailed
discussion of the mathmatics, see chapter 5 of Neter et al.,
Applied Linear Regression.</p>
<section id="id173">
<h3>Parameters:<a class="headerlink" href="#id173" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>x: np.array</dt><dd><p>The independent variable.</p>
</dd>
<dt>y: np.array</dt><dd><p>The dependent variable.</p>
</dd>
<dt>slope: float</dt><dd><p>The slope of the linear regression line.</p>
</dd>
<dt>intercept: float</dt><dd><p>The intercept of the linear regression line.</p>
</dd>
<dt>alpha: float</dt><dd><p>The alpha value of the confidence interval. Must be
in interval (0, 1).</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id174">
<h3>Returns:<a class="headerlink" href="#id174" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>lower_bound: np.array</dt><dd><p>Lower uncertainty bound at each y.</p>
</dd>
<dt>upper_bound: np.array</dt><dd><p>Upper uncertainty bound at each y.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.statistics.linear_regression">
<span class="sig-prename descclassname"><span class="pre">riserfit.statistics.</span></span><span class="sig-name descname"><span class="pre">linear_regression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignore</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/riserfit/statistics.html#linear_regression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.statistics.linear_regression" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the best fit slope and intercept for a set of
x and y coordinates, as well as the R2 correlation coefficient.</p>
<section id="id175">
<h3>Parameters:<a class="headerlink" href="#id175" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>x: ArrayLike</dt><dd><p>Independent coordinates.</p>
</dd>
<dt>y: ArrayLike</dt><dd><p>Dependent coordinates of length len(x).</p>
</dd>
<dt>weigths: ArrayLike</dt><dd><p>Weights of the data points.</p>
</dd>
<dt>ignore: list</dt><dd><p>List of indices to ignore for linear fitting and
correlation calculaten (e.g., list of outliers).</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id176">
<h3>Returns:<a class="headerlink" href="#id176" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>slope: float</dt><dd><p>The slope of the best fit linear function.</p>
</dd>
<dt>intercept: float</dt><dd><p>The y-axis intercept of the best fit linear
function.</p>
</dd>
<dt>r2: float</dt><dd><p>The R2 correlation coefficient.</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="riserfit.statistics.sample_2d_grid">
<span class="sig-prename descclassname"><span class="pre">riserfit.statistics.</span></span><span class="sig-name descname"><span class="pre">sample_2d_grid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax0_coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax1_coords</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">complex</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extrapolate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/riserfit/statistics.html#sample_2d_grid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#riserfit.statistics.sample_2d_grid" title="Permalink to this definition"></a></dt>
<dd><p>Uses scipy.interpolate.interpn() to sample an established
2d grid with respect to two variables,
like kt and a. Basically a wrapper around interpn().</p>
<section id="id177">
<h3>Parameters:<a class="headerlink" href="#id177" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>p0: float</dt><dd><p>Value along first axis (ax0) to be sampled.</p>
</dd>
<dt>p1: float</dt><dd><p>Value along second axis (ax1) to be sampled.</p>
</dd>
<dt>ax0_coords: ArrayLike</dt><dd><p>Coordinates of std_grid along axis 0.</p>
</dd>
<dt>ax1_coords: ArrayLike</dt><dd><p>Coordinates of std_grid along axis 1.</p>
</dd>
<dt>grid: np.ndarray</dt><dd><p>A 2d grid containing floats.</p>
</dd>
<dt>method: str</dt><dd><p>Interpolation method for scipy.interpolate.interpn().</p>
</dd>
<dt>extrapolate: bool</dt><dd><p>Whether to extrapolate from the original dataset.</p>
</dd>
</dl>
</div></blockquote>
</section>
<section id="id178">
<h3>Returns:<a class="headerlink" href="#id178" title="Permalink to this heading"></a></h3>
<blockquote>
<div><dl class="simple">
<dt>grid_value: float</dt><dd><p>The interpolated grid value at the sampled point .</p>
</dd>
</dl>
</div></blockquote>
</section>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="licence.html" class="btn btn-neutral float-left" title="Licence" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Lennart Grimm.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>